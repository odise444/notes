import{d as pe,k as ne,h as je,x as S,y,E as H,F as ve,z as e,G as Io,D as Pe,A as U,H as xe,I as q,J as ge,B as A,r as P,o as It,K as Ge,L as We,M as le,N as te,O as ce,P as Ne,Q as Xo,g as re,C as fe,s as qt,R as yt,S as lt,T as Yo,U as _o,V as Qt,W as He,X as Lo,Y as Ro}from"./DFjDwT1c.js";import{g as Oe,f as sl,w as al,a as Po,W as ut,S as pt,u as el,c as Wo,s as $t,b as rt,d as Eo,l as Fo,e as zo,h as jo,i as tl,j as To,k as Uo,m as Bo}from"./BBNf1ika.js";import{u as Ao}from"./D_2Bo9GB.js";const Go={key:0,class:"absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-5 bg-white rounded-r"},Oo={class:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50 pointer-events-none"},Vo=pe({__name:"ActivityBarItem",props:{icon:{},label:{},active:{type:Boolean}},emits:["click"],setup(n){const i=n,l=ne(()=>{switch(i.icon){case"furniture":return{render:()=>je("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",class:"w-5 h-5"},[je("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])};case"layers":return{render:()=>je("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",class:"w-5 h-5"},[je("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])};case"history":return{render:()=>je("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",class:"w-5 h-5"},[je("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])};case"settings":return{render:()=>je("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",class:"w-5 h-5"},[je("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),je("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})])};default:return{render:()=>je("div",{class:"w-5 h-5 bg-current rounded"})}}});return(c,r)=>(y(),S("button",{class:xe(["relative w-10 h-10 flex items-center justify-center rounded transition-colors group",[n.active?"bg-gray-700 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"]]),onClick:r[0]||(r[0]=h=>c.$emit("click"))},[n.active?(y(),S("div",Go)):H("",!0),(y(),ve(Io(l.value),{class:"w-5 h-5"})),e("div",Oo,[Pe(U(n.label)+" ",1),r[1]||(r[1]=e("div",{class:"absolute right-full top-1/2 -translate-y-1/2 border-4 border-transparent border-r-gray-900"},null,-1))])],2))}}),Ho=Object.assign(Vo,{__name:"LayoutActivityBarItem"}),No={class:"w-12 bg-gray-800 flex flex-col items-center py-2 shrink-0"},Ko={class:"flex flex-col gap-1"},Jo={class:"mt-auto flex flex-col gap-1"},Zo=pe({__name:"ActivityBar",props:{activePanel:{}},emits:["update:activePanel"],setup(n,{emit:i}){const l=i,c=[{id:"furniture",icon:"furniture",label:"ê°€êµ¬ ë¼ì´ë¸ŒëŸ¬ë¦¬"},{id:"layers",icon:"layers",label:"ë ˆì´ì–´"},{id:"history",icon:"history",label:"íˆìŠ¤í† ë¦¬"}],r=[{id:"settings",icon:"settings",label:"ì„¤ì •"}],h=k=>{l("update:activePanel",k)};return(k,_)=>{const b=Ho;return y(),S("nav",No,[e("div",Ko,[(y(),S(q,null,ge(c,$=>A(b,{key:$.id,icon:$.icon,label:$.label,active:n.activePanel===$.id,onClick:R=>h($.id)},null,8,["icon","label","active","onClick"])),64))]),e("div",Jo,[(y(),S(q,null,ge(r,$=>A(b,{key:$.id,icon:$.icon,label:$.label,active:n.activePanel===$.id,onClick:R=>h($.id)},null,8,["icon","label","active","onClick"])),64))])])}}}),qo=Object.assign(Zo,{__name:"LayoutActivityBar"}),Xt="floor-planner-custom-furniture",Qo="#9ca3af",ht=10,mt=500;function en(n){return{id:`custom-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:n.name,width:n.width,height:n.height,color:n.color||Qo,isCustom:!0}}function tn(n,i){const l=[];return isNaN(n)||isNaN(i)?(l.push("ìœ íš¨í•œ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),{valid:!1,errors:l}):(n<ht&&l.push(`ë„ˆë¹„ëŠ” ${ht}cm ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤`),n>mt&&l.push(`ë„ˆë¹„ëŠ” ${mt}cm ì´í•˜ì´ì–´ì•¼ í•©ë‹ˆë‹¤`),i<ht&&l.push(`ë†’ì´ëŠ” ${ht}cm ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤`),i>mt&&l.push(`ë†’ì´ëŠ” ${mt}cm ì´í•˜ì´ì–´ì•¼ í•©ë‹ˆë‹¤`),{valid:l.length===0,errors:l})}function Yt(){if(typeof localStorage>"u")return[];const n=localStorage.getItem(Xt);if(!n)return[];try{return JSON.parse(n)}catch{return[]}}function ln(n){const i=Yt(),l=i.findIndex(c=>c.id===n.id);l>=0?i[l]=n:i.push(n),localStorage.setItem(Xt,JSON.stringify(i))}function on(n){const l=Yt().filter(c=>c.id!==n);localStorage.setItem(Xt,JSON.stringify(l))}const nn={rect:{name:"ì‚¬ê°í˜•",icon:"â¬œ"},circle:{name:"ì›í˜•",icon:"â­•"},ellipse:{name:"íƒ€ì›í˜•",icon:"â¬­"},"l-shape":{name:"Lìí˜•",icon:"âŒ"}},sn={class:"flex flex-col h-full"},an={class:"flex-1 overflow-y-auto p-4"},rn={class:"space-y-2"},un=["onDragstart"],dn={class:"flex items-center gap-3"},cn={class:"flex-1"},vn={class:"text-sm font-medium text-gray-700"},fn={class:"text-xs text-gray-500"},gn=["onClick"],pn=["onDragstart"],hn={class:"flex items-center gap-3"},mn={class:"text-sm font-medium text-gray-700"},xn={class:"text-xs text-gray-500"},yn={key:0,class:"ml-1 text-gray-400"},bn={class:"bg-white rounded-lg shadow-xl p-6 w-80"},wn={class:"space-y-4"},kn={class:"flex gap-2"},Sn={key:0,class:"text-sm text-red-500"},Dn={class:"list-disc list-inside"},Mn=pe({__name:"FurnitureLibrary",emits:["add-door"],setup(n){const i=[{id:"sofa",name:"ì†ŒíŒŒ",width:200,height:90,color:"#6366f1",shape:"rect"},{id:"bed-single",name:"ì‹±ê¸€ ì¹¨ëŒ€",width:100,height:200,color:"#8b5cf6",shape:"rect"},{id:"bed-double",name:"ë”ë¸” ì¹¨ëŒ€",width:150,height:200,color:"#a855f7",shape:"rect"},{id:"dining-table",name:"ì‹íƒ",width:140,height:80,color:"#f59e0b",shape:"rect"},{id:"desk",name:"ì±…ìƒ",width:120,height:60,color:"#10b981",shape:"rect"},{id:"wardrobe",name:"ì˜·ì¥",width:120,height:60,color:"#6b7280",shape:"rect"},{id:"tv-stand",name:"TV ìŠ¤íƒ ë“œ",width:150,height:40,color:"#3b82f6",shape:"rect"},{id:"bookshelf",name:"ì±…ì¥",width:80,height:30,color:"#f97316",shape:"rect"},{id:"round-table",name:"ì›í˜• í…Œì´ë¸”",width:100,height:100,color:"#f59e0b",shape:"circle"},{id:"stool",name:"ì›í˜• ìŠ¤íˆ´",width:40,height:40,color:"#14b8a6",shape:"circle"},{id:"pouf",name:"í‘¸í”„",width:50,height:50,color:"#ec4899",shape:"circle"},{id:"oval-table",name:"íƒ€ì›í˜• í…Œì´ë¸”",width:160,height:90,color:"#f59e0b",shape:"ellipse"},{id:"bathtub",name:"ìš•ì¡°",width:170,height:80,color:"#06b6d4",shape:"ellipse"},{id:"oval-rug",name:"íƒ€ì›í˜• ëŸ¬ê·¸",width:200,height:150,color:"#a78bfa",shape:"ellipse"},{id:"l-sofa",name:"Lì ì†ŒíŒŒ",width:250,height:200,color:"#6366f1",shape:"l-shape",lShapeDirection:"bottom-right",lShapeRatio:.5},{id:"l-desk",name:"Lì ì±…ìƒ",width:180,height:150,color:"#10b981",shape:"l-shape",lShapeDirection:"bottom-right",lShapeRatio:.4},{id:"l-counter",name:"Lì ì¹´ìš´í„°",width:200,height:180,color:"#78716c",shape:"l-shape",lShapeDirection:"top-left",lShapeRatio:.5},{id:"chair",name:"ì˜ì",width:45,height:45,color:"#14b8a6",shape:"rect"},{id:"coffee-table",name:"ì»¤í”¼ í…Œì´ë¸”",width:100,height:50,color:"#eab308",shape:"rect"}],l=P([]),c=P(!1),r=P([]),h=P({name:"",width:100,height:60,color:"#9ca3af"});It(()=>{k()});function k(){l.value=Yt()}function _(){r.value=[],h.value.name.trim()||r.value.push("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");const X=tn(h.value.width,h.value.height);if(X.valid||r.value.push(...X.errors),r.value.length>0)return;const M=en({name:h.value.name.trim(),width:h.value.width,height:h.value.height,color:h.value.color});ln(M),k(),$()}function b(X){on(X),k()}function $(){c.value=!1,r.value=[],h.value={name:"",width:100,height:60,color:"#9ca3af"}}function R(X,M){X.dataTransfer&&(X.dataTransfer.setData("application/json",JSON.stringify(M)),X.dataTransfer.effectAllowed="copy")}function D(X){switch(X){case"circle":return"rounded-full";case"ellipse":return"rounded-full";case"l-shape":return"rounded-sm";default:return"rounded"}}return(X,M)=>(y(),S("div",sn,[M[16]||(M[16]=e("div",{class:"p-4 border-b border-gray-200"},[e("h2",{class:"font-medium text-gray-700"},"ê°€êµ¬ ë¼ì´ë¸ŒëŸ¬ë¦¬")],-1)),e("div",an,[e("div",rn,[e("div",{class:"p-3 bg-green-50 rounded-lg cursor-pointer hover:bg-green-100 transition-colors border-2 border-dashed border-green-300",onClick:M[0]||(M[0]=v=>X.$emit("add-door"))},[...M[7]||(M[7]=[e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-10 h-10 rounded flex items-center justify-center text-white text-xs bg-green-500"}," ğŸšª "),e("div",null,[e("div",{class:"text-sm font-medium text-gray-700"},"ë¬¸ ì¶”ê°€"),e("div",{class:"text-xs text-gray-500"},"ë²½ì— ë¬¸ ë°°ì¹˜")])],-1)])]),e("div",{class:"p-3 bg-blue-50 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors border-2 border-dashed border-blue-300",onClick:M[1]||(M[1]=v=>c.value=!0)},[...M[8]||(M[8]=[e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-10 h-10 rounded flex items-center justify-center text-white text-xs bg-blue-500"}," + "),e("div",null,[e("div",{class:"text-sm font-medium text-gray-700"},"ë‚´ ê°€êµ¬ ì¶”ê°€"),e("div",{class:"text-xs text-gray-500"},"í¬ê¸° ì§ì ‘ ì…ë ¥")])],-1)])]),l.value.length>0?(y(),S(q,{key:0},[M[9]||(M[9]=e("div",{class:"text-xs text-gray-500 mt-4 mb-2 font-medium"},"ë‚´ ê°€êµ¬",-1)),(y(!0),S(q,null,ge(l.value,v=>(y(),S("div",{key:v.id,class:"p-3 bg-blue-50 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors group relative",draggable:"true",onDragstart:u=>R(u,v)},[e("div",dn,[e("div",{class:"w-10 h-10 rounded flex items-center justify-center text-white text-xs",style:Ge({backgroundColor:v.color})},U(v.name.charAt(0)),5),e("div",cn,[e("div",vn,U(v.name),1),e("div",fn,U(v.width)+" Ã— "+U(v.height)+" cm ",1)]),e("button",{class:"opacity-0 group-hover:opacity-100 p-1 text-red-500 hover:bg-red-100 rounded transition-all",onClick:We(u=>b(v.id),["stop"]),title:"ì‚­ì œ"}," âœ• ",8,gn)])],40,un))),128))],64)):H("",!0),M[10]||(M[10]=e("div",{class:"text-xs text-gray-500 mt-4 mb-2 font-medium"},"ê¸°ë³¸ ê°€êµ¬",-1)),(y(),S(q,null,ge(i,v=>e("div",{key:v.id,class:"p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",draggable:"true",onDragstart:u=>R(u,v)},[e("div",hn,[e("div",{class:xe(["w-10 h-10 flex items-center justify-center text-white text-xs overflow-hidden",D(v.shape)]),style:Ge({backgroundColor:v.color})},U(v.name.charAt(0)),7),e("div",null,[e("div",mn,U(v.name),1),e("div",xn,[Pe(U(v.width)+" Ã— "+U(v.height)+" cm ",1),v.shape&&v.shape!=="rect"?(y(),S("span",yn," ("+U(le(nn)[v.shape].name)+") ",1)):H("",!0)])])])],40,pn)),64))])]),c.value?(y(),S("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:We($,["self"])},[e("div",bn,[M[15]||(M[15]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"ë‚´ ê°€êµ¬ ì¶”ê°€",-1)),e("div",wn,[e("div",null,[M[11]||(M[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ì´ë¦„",-1)),te(e("input",{"onUpdate:modelValue":M[2]||(M[2]=v=>h.value.name=v),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ì˜ˆ: ë‚´ ì±…ìƒ"},null,512),[[ce,h.value.name]])]),e("div",null,[M[12]||(M[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ë„ˆë¹„ (cm)",-1)),te(e("input",{"onUpdate:modelValue":M[3]||(M[3]=v=>h.value.width=v),type:"number",min:"10",max:"500",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"100"},null,512),[[ce,h.value.width,void 0,{number:!0}]])]),e("div",null,[M[13]||(M[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ë†’ì´ (cm)",-1)),te(e("input",{"onUpdate:modelValue":M[4]||(M[4]=v=>h.value.height=v),type:"number",min:"10",max:"500",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"60"},null,512),[[ce,h.value.height,void 0,{number:!0}]])]),e("div",null,[M[14]||(M[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ìƒ‰ìƒ",-1)),e("div",kn,[te(e("input",{"onUpdate:modelValue":M[5]||(M[5]=v=>h.value.color=v),type:"color",class:"w-12 h-10 rounded cursor-pointer border border-gray-300"},null,512),[[ce,h.value.color]]),te(e("input",{"onUpdate:modelValue":M[6]||(M[6]=v=>h.value.color=v),type:"text",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"#9ca3af"},null,512),[[ce,h.value.color]])])]),r.value.length>0?(y(),S("div",Sn,[e("ul",Dn,[(y(!0),S(q,null,ge(r.value,v=>(y(),S("li",{key:v},U(v),1))),128))])])):H("",!0)]),e("div",{class:"flex gap-3 mt-6"},[e("button",{class:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",onClick:$}," ì·¨ì†Œ "),e("button",{class:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",onClick:_}," ì¶”ê°€ ")])])])):H("",!0)]))}}),Cn=Object.assign(Mn,{__name:"SidebarFurnitureLibrary"}),$n={class:"flex items-center justify-between p-3 border-b"},In={class:"flex items-center gap-2"},Xn={key:0,class:"px-3 py-2 bg-purple-50 border-b text-xs text-purple-700"},Yn={class:"flex-1 overflow-y-auto p-2"},_n={key:0,class:"text-center text-gray-400 text-sm py-4"},Ln=["onClick","onDragstart","onDragover","onDrop"],Rn=["onClick"],Pn={key:1,class:"w-4 h-4 flex-shrink-0 flex items-center justify-center text-gray-400"},Wn=["checked","onClick"],En={key:3,class:"cursor-grab text-gray-400 hover:text-gray-600"},Fn={key:6,class:"w-6 h-6 rounded border-2 border-gray-600 flex-shrink-0 bg-white"},zn={class:"flex-1 min-w-0"},jn={class:"text-sm text-gray-800 truncate"},Tn={class:"text-xs text-gray-400"},Un={key:0,class:"ml-1"},Bn={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},An={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Gn={key:2,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},On={key:3,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Vn={key:4,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Hn={key:9,class:"flex flex-col gap-0.5"},Nn=["disabled","onClick"],Kn=["disabled","onClick"],Jn={class:"border-t p-2 space-y-1"},Zn={key:0,class:"flex gap-1"},qn=["disabled"],Qn={class:"flex gap-1"},es=["disabled"],ts=["disabled"],ls=pe({__name:"LayerPanel",props:{items:{},selectedId:{},image:{},selectedImageId:{},room:{},selectedRoomId:{},walls:{},selectedWallId:{},groups:{},selectedGroupId:{},embedded:{type:Boolean},multiSelectedItems:{}},emits:["close","select","select-image","select-room","select-wall","select-group","move-forward","move-backward","bring-to-front","send-to-back","reorder","reorder-unified","create-group","ungroup","toggle-multi-select","clear-selection"],setup(n,{emit:i}){const l=n,c=i,r=P(!1),h=P([]);Ne(()=>l.multiSelectedItems,m=>{m&&m.length>0?(r.value=!0,h.value=m.filter(C=>C.type==="furniture"||C.type==="wall").map(C=>({id:C.id,type:C.type}))):h.value=[]},{deep:!0});const k=P(null),_=P(null),b=P(null),$=()=>{r.value=!r.value,r.value||(h.value=[])},R=()=>{h.value=[]},D=m=>h.value.some(C=>C.id===m.id&&C.type===m.type),X=m=>{const C=h.value.findIndex(L=>L.id===m.id&&L.type===m.type);C!==-1?h.value.splice(C,1):h.value.push({id:m.id,type:m.type})},M=ne(()=>h.value.some(m=>m.type==="group")),v=()=>{if(h.value.length<2)return;const m=h.value.filter(C=>C.type==="furniture"||C.type==="wall"||C.type==="group"||C.type==="room").map(C=>({id:C.id,type:C.type}));m.length>=2&&(c("create-group",m),h.value=[],r.value=!1)},u=()=>{const m=h.value.find(C=>C.type==="group");m&&(c("ungroup",m.id),h.value=[])},F=P(new Set),ue=m=>{F.value.has(m)?F.value.delete(m):F.value.add(m)},ae=ne(()=>{const m=new Set;if(l.groups)for(const C of l.groups)for(const L of C.members)m.add(L.id);return m}),W=ne(()=>{const m=[];if(l.groups){for(const j of l.groups)if(m.push({id:j.id,type:"group",name:j.name,zIndex:j.zIndex,color:j.color,width:j.width,height:j.height,memberCount:j.members.length,original:j,depth:0}),F.value.has(j.id))for(const oe of j.members)if(oe.type==="furniture"){const de=l.items.find(J=>J.id===oe.id);de&&m.push({id:de.id,type:"furniture",name:de.name,zIndex:de.zIndex,color:de.color,width:de.width,height:de.height,original:de,parentGroupId:j.id,depth:1})}else if(oe.type==="wall"){const de=l.walls?.find(J=>J.id===oe.id);if(de){const J=Math.round(Oe(de));m.push({id:de.id,type:"wall",name:de.isExterior?"ì™¸ë²½":"ë‚´ë²½",zIndex:de.zIndex,color:de.color,width:J,height:de.thickness,original:de,parentGroupId:j.id,depth:1})}}else oe.type==="room"&&l.room&&l.room.id===oe.id&&m.push({id:l.room.id,type:"room",name:"ë°©",zIndex:l.room.zIndex,width:l.room.width,height:l.room.height,opacity:l.room.opacity,original:l.room,parentGroupId:j.id,depth:1})}for(const j of l.items)ae.value.has(j.id)||m.push({id:j.id,type:"furniture",name:j.name,zIndex:j.zIndex,color:j.color,width:j.width,height:j.height,original:j,depth:0});if(l.image&&m.push({id:l.image.id,type:"image",name:l.image.originalName||"í‰ë©´ë„ ì´ë¯¸ì§€",zIndex:l.image.zIndex,width:l.image.width,height:l.image.height,dataUrl:l.image.dataUrl,opacity:l.image.opacity,locked:l.image.locked,original:l.image,depth:0}),l.room&&!ae.value.has(l.room.id)&&m.push({id:l.room.id,type:"room",name:"ë°©",zIndex:l.room.zIndex,width:l.room.width,height:l.room.height,opacity:l.room.opacity,original:l.room,depth:0}),l.walls){for(const j of l.walls)if(!ae.value.has(j.id)){const oe=Math.round(Oe(j));m.push({id:j.id,type:"wall",name:j.isExterior?"ì™¸ë²½":"ë‚´ë²½",zIndex:j.zIndex,color:j.color,width:oe,height:j.thickness,original:j,depth:0})}}const C=m.filter(j=>!j.parentGroupId);C.sort((j,oe)=>oe.zIndex-j.zIndex);const L=[];for(const j of C)if(L.push(j),j.type==="group"&&F.value.has(j.id)){const oe=m.filter(de=>de.parentGroupId===j.id);L.push(...oe)}return L}),se=ne(()=>W.value.length),Xe=m=>{switch(m){case"image":return"bg-purple-50 border border-purple-200";case"room":return"bg-gray-100 border border-gray-300";case"wall":return"bg-green-50 border border-green-200";case"group":return"bg-purple-100 border border-purple-300";default:return"bg-blue-50 border border-blue-200"}},De=m=>{switch(m){case"image":return"text-purple-500";case"room":return"text-gray-600";case"wall":return"text-green-600";case"group":return"text-purple-600";default:return"text-blue-500"}},Me=m=>{if(W.value.length<=1)return!0;const C=Math.max(...W.value.map(L=>L.zIndex));return m.zIndex===C},Ce=m=>{if(W.value.length<=1)return!0;const C=Math.min(...W.value.map(L=>L.zIndex));return m.zIndex===C},Ie=(m,C)=>{if(r.value){C.ctrlKey||C.metaKey?X(m):h.value=[{id:m.id,type:m.type}];return}if((C.ctrlKey||C.metaKey)&&(m.type==="furniture"||m.type==="wall")){c("toggle-multi-select",m.id,m.type);return}c("clear-selection"),m.type==="furniture"?c("select",m.original):m.type==="image"?c("select-image",m.original):m.type==="room"?c("select-room",m.original):m.type==="wall"?c("select-wall",m.original):m.type==="group"&&c("select-group",m.original)},Ye=(m,C)=>l.multiSelectedItems?.some(L=>L.id===m&&L.type===C)??!1,V=m=>m.type==="furniture"&&Ye(m.id,"furniture")||m.type==="wall"&&Ye(m.id,"wall")?!0:m.type==="furniture"?l.selectedId===m.id:m.type==="image"?l.selectedImageId===m.id:m.type==="room"?l.selectedRoomId===m.id:m.type==="wall"?l.selectedWallId===m.id:m.type==="group"?l.selectedGroupId===m.id:!1,G=(m,C,L)=>{if(r.value){m.preventDefault();return}k.value=C.id,_.value=C.type,m.dataTransfer&&(m.dataTransfer.effectAllowed="move",m.dataTransfer.setData("text/plain",C.id),m.dataTransfer.setData("item-type",C.type))},w=()=>{k.value=null,_.value=null,b.value=null},Y=(m,C)=>{r.value||(b.value=C)},E=()=>{b.value=null},ie=(m,C)=>{k.value&&_.value&&c("reorder-unified",k.value,_.value,C),k.value=null,_.value=null,b.value=null};return(m,C)=>(y(),S("div",{class:xe(["flex flex-col",n.embedded?"h-full w-full":"bg-white rounded-lg shadow-lg w-72 max-h-[500px]"])},[e("div",$n,[C[5]||(C[5]=e("h3",{class:"font-semibold text-gray-800 text-sm"},"ë ˆì´ì–´",-1)),e("div",In,[e("button",{class:xe(["p-1 rounded",r.value?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-gray-600"]),title:"ë‹¤ì¤‘ ì„ íƒ ëª¨ë“œ",onClick:$},[...C[3]||(C[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],2),n.embedded?H("",!0):(y(),S("button",{key:0,class:"text-gray-400 hover:text-gray-600",onClick:C[0]||(C[0]=L=>m.$emit("close"))},[...C[4]||(C[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]))])]),r.value&&h.value.length>0?(y(),S("div",Xn,[Pe(U(h.value.length)+"ê°œ ì„ íƒë¨ ",1),e("button",{class:"ml-2 underline",onClick:R},"ì„ íƒ í•´ì œ")])):H("",!0),e("div",Yn,[se.value===0?(y(),S("div",_n," ë ˆì´ì–´ê°€ ì—†ìŠµë‹ˆë‹¤ ")):H("",!0),(y(!0),S(q,null,ge(W.value,(L,j)=>(y(),S("div",{key:L.id,draggable:"true",class:xe(["flex items-center gap-2 p-2 rounded cursor-grab transition-colors",[D(L)?"bg-purple-50 border border-purple-300":V(L)?Xe(L.type):"hover:bg-gray-50",b.value===j?"border-t-2 border-blue-500":"",k.value===L.id?"opacity-50":""]]),style:Ge({paddingLeft:`${(L.depth||0)*16+8}px`}),onClick:oe=>Ie(L,oe),onDragstart:oe=>G(oe,L),onDragend:w,onDragover:We(oe=>Y(oe,j),["prevent"]),onDragleave:E,onDrop:We(oe=>ie(oe,j),["prevent"])},[L.type==="group"?(y(),S("button",{key:0,class:"w-4 h-4 flex-shrink-0 text-gray-500 hover:text-gray-700",onClick:We(oe=>ue(L.id),["stop"])},[(y(),S("svg",{class:xe(["w-4 h-4 transition-transform",F.value.has(L.id)?"rotate-90":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...C[6]||(C[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))],8,Rn)):L.parentGroupId?(y(),S("div",Pn,[...C[7]||(C[7]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])):H("",!0),r.value?(y(),S("input",{key:2,type:"checkbox",checked:D(L),class:"w-4 h-4 text-purple-600 rounded border-gray-300 focus:ring-purple-500",onClick:We(oe=>X(L),["stop"])},null,8,Wn)):H("",!0),!r.value&&!L.parentGroupId?(y(),S("div",En,[...C[8]||(C[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8h16M4 16h16"})],-1)])])):H("",!0),L.type==="group"?(y(),S("div",{key:4,class:"w-6 h-6 rounded border-2 flex-shrink-0 flex items-center justify-center",style:Ge({borderColor:L.color,backgroundColor:L.color+"20"})},[(y(),S("svg",{class:"w-4 h-4",style:Ge({color:L.color}),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...C[9]||(C[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},null,-1)])],4))],4)):L.type==="image"?(y(),S("div",{key:5,class:"w-6 h-6 rounded border border-gray-300 flex-shrink-0 bg-cover bg-center",style:Ge({backgroundImage:`url(${L.dataUrl})`})},null,4)):L.type==="room"?(y(),S("div",Fn)):L.type==="wall"?(y(),S("div",{key:7,class:"w-6 h-6 rounded border border-gray-300 flex-shrink-0 flex items-center justify-center",style:Ge({backgroundColor:L.color})},[...C[10]||(C[10]=[e("div",{class:"w-4 h-1 bg-white opacity-50 rounded"},null,-1)])],4)):(y(),S("div",{key:8,class:"w-6 h-6 rounded border border-gray-300 flex-shrink-0",style:Ge({backgroundColor:L.color})},null,4)),e("div",zn,[e("div",jn,U(L.name),1),e("div",Tn,[L.type==="group"?(y(),S(q,{key:0},[Pe(U(L.memberCount)+"ê°œ ê°ì²´ ",1)],64)):L.type==="image"?(y(),S(q,{key:1},[Pe(U(Math.round((L.opacity??1)*100))+"% íˆ¬ëª…ë„ ",1),L.locked?(y(),S("span",Un,"ğŸ”’")):H("",!0)],64)):L.type==="room"?(y(),S(q,{key:2},[Pe(U(Math.round(L.width))+"Ã—"+U(Math.round(L.height))+"px ",1)],64)):L.type==="wall"?(y(),S(q,{key:3},[Pe(" ê¸¸ì´: "+U(L.width)+"cm, ë‘ê»˜: "+U(L.height)+"cm ",1)],64)):(y(),S(q,{key:4},[Pe(U(L.width)+"Ã—"+U(L.height)+"cm ",1)],64))])]),e("div",{class:xe(De(L.type))},[L.type==="group"?(y(),S("svg",Bn,[...C[11]||(C[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},null,-1)])])):L.type==="image"?(y(),S("svg",An,[...C[12]||(C[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1)])])):L.type==="room"?(y(),S("svg",Gn,[...C[13]||(C[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"},null,-1)])])):L.type==="wall"?(y(),S("svg",On,[...C[14]||(C[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,-1)])])):(y(),S("svg",Vn,[...C[15]||(C[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"},null,-1)])]))],2),r.value?H("",!0):(y(),S("div",Hn,[e("button",{class:"p-0.5 hover:bg-gray-200 rounded text-gray-500 disabled:opacity-30 disabled:cursor-not-allowed",disabled:Me(L),title:"ìœ„ë¡œ",onClick:We(oe=>L.type==="furniture"&&m.$emit("move-forward",L.original),["stop"])},[...C[16]||(C[16]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"})],-1)])],8,Nn),e("button",{class:"p-0.5 hover:bg-gray-200 rounded text-gray-500 disabled:opacity-30 disabled:cursor-not-allowed",disabled:Ce(L),title:"ì•„ë˜ë¡œ",onClick:We(oe=>L.type==="furniture"&&m.$emit("move-backward",L.original),["stop"])},[...C[17]||(C[17]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])],8,Kn)]))],46,Ln))),128))]),e("div",Jn,[r.value?(y(),S("div",Zn,[e("button",{class:"flex-1 px-2 py-1.5 text-xs bg-purple-500 text-white rounded hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:h.value.length<2,onClick:v}," ê·¸ë£¹í™” ("+U(h.value.length)+") ",9,qn),M.value?(y(),S("button",{key:0,class:"flex-1 px-2 py-1.5 text-xs bg-orange-500 text-white rounded hover:bg-orange-600",onClick:u}," ê·¸ë£¹ í•´ì œ ")):H("",!0)])):H("",!0),e("div",Qn,[e("button",{class:"flex-1 px-2 py-1.5 text-xs bg-gray-100 hover:bg-gray-200 rounded disabled:opacity-50",disabled:!n.selectedId&&!n.selectedImageId&&!n.selectedRoomId&&!n.selectedWallId,onClick:C[1]||(C[1]=L=>m.$emit("bring-to-front"))}," ë§¨ ì•ìœ¼ë¡œ ",8,es),e("button",{class:"flex-1 px-2 py-1.5 text-xs bg-gray-100 hover:bg-gray-200 rounded disabled:opacity-50",disabled:!n.selectedId&&!n.selectedImageId&&!n.selectedRoomId&&!n.selectedWallId,onClick:C[2]||(C[2]=L=>m.$emit("send-to-back"))}," ë§¨ ë’¤ë¡œ ",8,ts)])])],2))}}),os=Object.assign(ls,{__name:"EditorLayerPanel"}),ns={class:"flex flex-col h-full"},ss={class:"p-4 space-y-3"},as={class:"flex gap-2"},is=["disabled"],rs=["disabled"],us=pe({__name:"HistoryPanel",props:{canUndo:{type:Boolean},canRedo:{type:Boolean}},emits:["undo","redo"],setup(n,{emit:i}){const l=i;return(c,r)=>(y(),S("div",ns,[r[5]||(r[5]=e("div",{class:"p-4 border-b border-gray-200"},[e("h2",{class:"font-medium text-gray-700"},"íˆìŠ¤í† ë¦¬")],-1)),e("div",ss,[e("div",as,[e("button",{class:"flex-1 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:!n.canUndo,onClick:r[0]||(r[0]=h=>l("undo"))},[...r[2]||(r[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})],-1),Pe(" ì‹¤í–‰ ì·¨ì†Œ ",-1)])],8,is),e("button",{class:"flex-1 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:!n.canRedo,onClick:r[1]||(r[1]=h=>l("redo"))},[...r[3]||(r[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})],-1),Pe(" ë‹¤ì‹œ ì‹¤í–‰ ",-1)])],8,rs)]),r[4]||(r[4]=e("div",{class:"text-xs text-gray-500 text-center"}," ë‹¨ì¶•í‚¤: Ctrl+Z (ì‹¤í–‰ ì·¨ì†Œ), Ctrl+Y (ë‹¤ì‹œ ì‹¤í–‰) ",-1))])]))}}),ds=Object.assign(us,{__name:"PanelHistoryPanel"}),cs={class:"flex flex-col h-full"},vs={class:"p-4 space-y-4"},fs={class:"flex items-center justify-between"},gs={class:"flex items-center justify-between"},ps={class:"space-y-2"},hs={class:"flex items-center gap-2"},ms=["value"],xs={class:"text-sm text-gray-500 w-12 text-right"},ys=pe({__name:"SettingsPanel",props:{showGrid:{type:Boolean},snapToGrid:{type:Boolean},gridSize:{}},emits:["update:showGrid","update:snapToGrid","update:gridSize"],setup(n,{emit:i}){const l=i;return(c,r)=>(y(),S("div",cs,[r[7]||(r[7]=e("div",{class:"p-4 border-b border-gray-200"},[e("h2",{class:"font-medium text-gray-700"},"ì„¤ì •")],-1)),e("div",vs,[e("div",fs,[r[3]||(r[3]=e("label",{class:"text-sm text-gray-700"},"ê·¸ë¦¬ë“œ í‘œì‹œ",-1)),e("button",{class:xe(["w-10 h-6 rounded-full transition-colors relative",n.showGrid?"bg-blue-500":"bg-gray-300"]),onClick:r[0]||(r[0]=h=>l("update:showGrid",!n.showGrid))},[e("span",{class:xe(["absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-all",n.showGrid?"left-5":"left-1"])},null,2)],2)]),e("div",gs,[r[4]||(r[4]=e("label",{class:"text-sm text-gray-700"},"ê·¸ë¦¬ë“œì— ìŠ¤ëƒ…",-1)),e("button",{class:xe(["w-10 h-6 rounded-full transition-colors relative",n.snapToGrid?"bg-blue-500":"bg-gray-300"]),onClick:r[1]||(r[1]=h=>l("update:snapToGrid",!n.snapToGrid))},[e("span",{class:xe(["absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-all",n.snapToGrid?"left-5":"left-1"])},null,2)],2)]),e("div",ps,[r[5]||(r[5]=e("label",{class:"text-sm text-gray-700"},"ê·¸ë¦¬ë“œ í¬ê¸°",-1)),e("div",hs,[e("input",{type:"range",value:n.gridSize,min:"10",max:"100",step:"10",class:"flex-1",onInput:r[2]||(r[2]=h=>l("update:gridSize",Number(h.target.value)))},null,40,ms),e("span",xs,U(n.gridSize)+"px",1)])]),r[6]||(r[6]=Xo('<hr class="border-gray-200"><div class="space-y-2"><h3 class="text-sm font-medium text-gray-700">ë‹¨ì¶•í‚¤</h3><div class="text-xs text-gray-500 space-y-1"><div class="flex justify-between"><span>ì„ íƒ ì‚­ì œ</span><span class="text-gray-400">Delete</span></div><div class="flex justify-between"><span>íšŒì „</span><span class="text-gray-400">R</span></div><div class="flex justify-between"><span>ì‹¤í–‰ ì·¨ì†Œ</span><span class="text-gray-400">Ctrl+Z</span></div><div class="flex justify-between"><span>ë‹¤ì‹œ ì‹¤í–‰</span><span class="text-gray-400">Ctrl+Y</span></div><div class="flex justify-between"><span>ê·¸ë£¹í™”</span><span class="text-gray-400">Ctrl+G</span></div><div class="flex justify-between"><span>ê·¸ë£¹ í•´ì œ</span><span class="text-gray-400">Ctrl+Shift+G</span></div><div class="flex justify-between"><span>ë ˆì´ì–´ íŒ¨ë„</span><span class="text-gray-400">L</span></div></div></div>',2))])]))}}),bs=Object.assign(ys,{__name:"PanelSettingsPanel"}),ws=pe({__name:"RoomLayer",props:{room:{},scale:{},isSelected:{type:Boolean}},emits:["mousedown","click","dblclick","transformend"],setup(n,{expose:i,emit:l}){const c=l,r=P(null);return i({roomRectRef:r}),(h,k)=>{const _=re("v-rect"),b=re("v-group"),$=re("v-text");return y(),S(q,null,[n.room?(y(),ve(b,{key:0},{default:fe(()=>[A(_,{ref_key:"roomRectRef",ref:r,config:{x:n.room.x,y:n.room.y,width:n.room.width,height:n.room.height,fill:"#ffffff",stroke:"transparent",strokeWidth:0,opacity:n.room.opacity,name:"room"},onMousedown:k[0]||(k[0]=R=>c("mousedown",R)),onClick:k[1]||(k[1]=R=>c("click")),onDblclick:k[2]||(k[2]=R=>c("dblclick")),onTransformend:k[3]||(k[3]=R=>c("transformend",R))},null,8,["config"]),n.isSelected?(y(),ve(_,{key:0,config:{x:n.room.x,y:n.room.y,width:n.room.width,height:n.room.height,fill:"transparent",stroke:"#3b82f6",strokeWidth:3,listening:!1}},null,8,["config"])):H("",!0)]),_:1})):H("",!0),n.room?(y(),S(q,{key:1},[A($,{config:{x:n.room.x+n.room.width/2,y:n.room.y-25,text:`${Math.round(n.room.width/n.scale)}cm`,fontSize:14,fill:"#374151",align:"center",offsetX:25}},null,8,["config"]),A($,{config:{x:n.room.x-25,y:n.room.y+n.room.height/2,text:`${Math.round(n.room.height/n.scale)}cm`,fontSize:14,fill:"#374151",align:"center",rotation:-90,offsetX:25}},null,8,["config"])],64)):H("",!0)],64)}}}),ks=Object.assign(ws,{__name:"CanvasRoomLayer"});function Ss(n,i,l,c){const r=i==="inside",h=l==="left";let k=0,_=0,b=0;switch(n){case"top":k=h?0:c,_=r?10:0,r?b=h?0:90:b=h?-90:180;break;case"bottom":k=h?0:c,_=r?0:10,r?b=h?-90:180:b=h?0:90;break;case"left":k=r?10:0,_=h?0:c,r?b=h?0:-90:b=h?90:180;break;case"right":k=r?0:10,_=h?0:c,r?b=h?90:180:b=h?0:-90;break}return{x:k,y:_,rotation:b}}const Ds=pe({__name:"DoorLayer",props:{doors:{},room:{},scale:{},selectedDoorId:{},multiSelectedIds:{}},emits:["select","dblclick","dragstart","dragend"],setup(n,{emit:i}){const l=n,c=i,r=b=>l.multiSelectedIds.includes(b),h=b=>{if(!l.room)return{x:0,y:0,draggable:!0};const $=l.room;let R=0,D=0;switch(b.wall){case"top":R=$.x+b.x*l.scale,D=$.y-5;break;case"bottom":R=$.x+b.x*l.scale,D=$.y+$.height-5;break;case"left":R=$.x-5,D=$.y+b.y*l.scale;break;case"right":R=$.x+$.width-5,D=$.y+b.y*l.scale;break}return{x:R,y:D,draggable:!0}},k=b=>{const $=b.width*l.scale,R=Ss(b.wall,b.openDirection,b.hingeSide,$);return{x:R.x,y:R.y,innerRadius:0,outerRadius:$,angle:90,rotation:R.rotation,clockwise:!1,fill:"transparent",stroke:"#6b7280",strokeWidth:1,dash:[4,4]}},_=b=>{const $=b.width*l.scale,R=k(b),D=R.x,X=R.y,M=(R.rotation+45)*Math.PI/180,v=D+$*Math.cos(M),u=X+$*Math.sin(M);return{points:[D,X,v,u],stroke:"#374151",strokeWidth:2}};return(b,$)=>{const R=re("v-rect"),D=re("v-arc"),X=re("v-line"),M=re("v-text"),v=re("v-group");return y(!0),S(q,null,ge(n.doors,u=>(y(),ve(v,{key:u.id,config:h(u),onClick:F=>c("select",u,F),onDblclick:F=>c("dblclick",u),onDragstart:F=>c("dragstart",u,F),onDragend:F=>c("dragend",u,F)},{default:fe(()=>[A(R,{config:{width:u.wall==="top"||u.wall==="bottom"?u.width*n.scale:10,height:u.wall==="left"||u.wall==="right"?u.width*n.scale:10,fill:"#ffffff",stroke:r(u.id)?"#22c55e":n.selectedDoorId===u.id?"#3b82f6":"#374151",strokeWidth:r(u.id)||n.selectedDoorId===u.id?2:1}},null,8,["config"]),r(u.id)?(y(),ve(R,{key:0,config:{x:-4,y:-4,width:(u.wall==="top"||u.wall==="bottom"?u.width*n.scale:10)+8,height:(u.wall==="left"||u.wall==="right"?u.width*n.scale:10)+8,stroke:"#22c55e",strokeWidth:2,dash:[6,3],listening:!1}},null,8,["config"])):H("",!0),A(D,{config:k(u)},null,8,["config"]),A(X,{config:_(u)},null,8,["config"]),A(M,{config:{text:`${u.width}`,fontSize:10,fill:"#374151",x:u.wall==="top"||u.wall==="bottom"?u.width*n.scale/2-10:-15,y:u.wall==="left"||u.wall==="right"?u.width*n.scale/2-5:-15}},null,8,["config"])]),_:2},1032,["config","onClick","onDblclick","onDragstart","onDragend"]))),128)}}}),Ms=Object.assign(Ds,{__name:"CanvasDoorLayer"}),Cs=pe({__name:"WallLayer",props:{walls:{},scale:{},selectedWallId:{},multiSelectedIds:{},isWallDrawMode:{type:Boolean},showPolygonView:{type:Boolean},wallDrawPreview:{}},emits:["click","dblclick","dragstart","dragend","endpointDrag","endpointDragEnd"],setup(n,{emit:i}){const l=n,c=i,r=$=>l.multiSelectedIds.includes($),h=ne(()=>{if(!l.showPolygonView||l.walls.length===0)return[];const $=sl(l.walls),R=[];return $.forEach((D,X)=>{const M=al(D);M&&R.push({...M,id:`polygon-${X}`})}),R}),k=$=>{const R=Po($,l.scale),D=l.selectedWallId===$.id,X=r($.id);let M=$.color||ut.interior,v="#374151",u=1;return X?(v="#22c55e",u=3):D&&(M="#3b82f6",v="#1d4ed8",u=2),{x:R.x,y:R.y,width:R.width,height:R.height,rotation:R.rotation,fill:M,stroke:v,strokeWidth:u,dash:X?[8,4]:void 0,offsetX:0,offsetY:R.height/2}},_=$=>{const R=Oe($),D=($.startX+$.endX)/2*l.scale,X=($.startY+$.endY)/2*l.scale,M=Math.atan2($.endY-$.startY,$.endX-$.startX),v=-20;return{x:D+Math.sin(M)*v,y:X-Math.cos(M)*v,text:`${Math.round(R)}cm`,fontSize:12,fill:"#374151",align:"center",offsetX:20}},b=$=>{const R=l.scale,D=[];for(let v=$.innerPoints.length-2;v>=0;v-=2)D.push($.innerPoints[v]*R,$.innerPoints[v+1]*R);return{points:[...$.outerPoints.map(v=>v*R),...D],stroke:$.color,strokeWidth:1,closed:!0,fill:$.color,opacity:.8}};return($,R)=>{const D=re("v-line"),X=re("v-rect"),M=re("v-text"),v=re("v-circle");return y(),S(q,null,[n.showPolygonView?(y(!0),S(q,{key:0},ge(h.value,u=>(y(),ve(D,{key:u.id,config:b(u)},null,8,["config"]))),128)):H("",!0),n.showPolygonView?H("",!0):(y(!0),S(q,{key:1},ge(n.walls,u=>(y(),S(q,{key:u.id},[A(X,{config:{...k(u),draggable:n.selectedWallId===u.id&&!n.isWallDrawMode},onClick:F=>c("click",u,F),onDblclick:F=>c("dblclick",u),onDragstart:F=>c("dragstart",F,u),onDragend:F=>c("dragend",F,u)},null,8,["config","onClick","onDblclick","onDragstart","onDragend"]),A(M,{config:_(u)},null,8,["config"]),n.selectedWallId===u.id&&!n.isWallDrawMode?(y(),S(q,{key:0},[A(v,{config:{x:u.startX*n.scale,y:u.startY*n.scale,radius:8,fill:"#3b82f6",stroke:"#ffffff",strokeWidth:2,draggable:!0,name:"wall-handle-start"},onDragmove:F=>c("endpointDrag",F,u,"start"),onDragend:F=>c("endpointDragEnd",F,u,"start")},null,8,["config","onDragmove","onDragend"]),A(v,{config:{x:u.endX*n.scale,y:u.endY*n.scale,radius:8,fill:"#3b82f6",stroke:"#ffffff",strokeWidth:2,draggable:!0,name:"wall-handle-end"},onDragmove:F=>c("endpointDrag",F,u,"end"),onDragend:F=>c("endpointDragEnd",F,u,"end")},null,8,["config","onDragmove","onDragend"])],64)):H("",!0)],64))),128)),n.wallDrawPreview?(y(),ve(D,{key:2,config:{points:[n.wallDrawPreview.startX,n.wallDrawPreview.startY,n.wallDrawPreview.endX,n.wallDrawPreview.endY],stroke:"#22c55e",strokeWidth:15*n.scale,lineCap:"round",dash:[10,5],opacity:.7}},null,8,["config"])):H("",!0)],64)}}}),$s=Object.assign(Cs,{__name:"CanvasWallLayer"}),Is=pe({__name:"FurnitureLayer",props:{furnitureList:{},scale:{},multiSelectedIds:{}},emits:["dragstart","dragmove","dragend","select","dblclick","transformend"],setup(n,{expose:i,emit:l}){const c=n,r=l,h=P(new Map),k=(D,X)=>{X?h.value.set(D,X):h.value.delete(D)},_=D=>c.multiSelectedIds.includes(D),b=D=>({x:D.x+D.width*c.scale/2,y:D.y+D.height*c.scale/2,offsetX:D.width*c.scale/2,offsetY:D.height*c.scale/2,rotation:D.rotation,draggable:!0,name:`furniture-${D.id}`,zIndex:D.zIndex}),$=D=>{const X=D.width*c.scale,M=D.height*c.scale,v=D.lShapeRatioW??D.lShapeRatio??.5,u=D.lShapeRatioH??D.lShapeRatio??.5,F=D.lShapeDirection||"bottom-right";let ue=[];const ae=X*v,W=M*u;switch(F){case"bottom-right":ue=[0,W,ae,W,ae,0,X,0,X,M,0,M];break;case"bottom-left":ue=[0,0,X-ae,0,X-ae,W,X,W,X,M,0,M];break;case"top-right":ue=[0,0,X,0,X,M-W,X-ae,M-W,X-ae,M,0,M];break;case"top-left":ue=[0,0,X,0,X,M,ae,M,ae,M-W,0,M-W];break}return{points:ue,fill:D.color,stroke:"#374151",strokeWidth:1,closed:!0}},R=D=>{const X=D.width*c.scale,M=D.height*c.scale;if(D.shape!=="l-shape")return{text:D.name,fontSize:12,fill:"#ffffff",width:X,height:M,align:"center",verticalAlign:"middle",padding:4};D.lShapeRatioW??D.lShapeRatio;const v=D.lShapeRatioH??D.lShapeRatio??.5,u=D.lShapeDirection||"bottom-right",F=M*v;let ue=0,ae=0,W=X,se=M;switch(u){case"bottom-right":case"bottom-left":ue=0,ae=F,W=X,se=M-F;break;case"top-right":case"top-left":ue=0,ae=0,W=X,se=M-F;break}return{text:D.name,fontSize:12,fill:"#ffffff",x:ue,y:ae,width:W,height:se,align:"center",verticalAlign:"middle",padding:4}};return i({furnitureRefs:h,setFurnitureRef:k}),(D,X)=>{const M=re("v-rect"),v=re("v-circle"),u=re("v-ellipse"),F=re("v-line"),ue=re("v-text"),ae=re("v-group");return y(!0),S(q,null,ge(n.furnitureList,W=>(y(),ve(ae,{key:W.id,ref_for:!0,ref:se=>k(W.id,se),config:b(W),onDragstart:se=>r("dragstart",W,se),onDragmove:se=>r("dragmove",W,se),onDragend:se=>r("dragend",W,se),onClick:se=>r("select",W,se),onDblclick:se=>r("dblclick",W),onTransformend:se=>r("transformend",W,se)},{default:fe(()=>[_(W.id)?(y(),ve(M,{key:0,config:{x:-4,y:-4,width:W.width*n.scale+8,height:W.height*n.scale+8,stroke:"#22c55e",strokeWidth:2,dash:[6,3],cornerRadius:6,listening:!1}},null,8,["config"])):H("",!0),!W.shape||W.shape==="rect"?(y(),ve(M,{key:1,config:{width:W.width*n.scale,height:W.height*n.scale,fill:W.color,stroke:_(W.id)?"#22c55e":"#374151",strokeWidth:_(W.id)?2:1,cornerRadius:4}},null,8,["config"])):W.shape==="circle"?(y(),ve(v,{key:2,config:{x:W.width*n.scale/2,y:W.height*n.scale/2,radius:Math.min(W.width,W.height)*n.scale/2,fill:W.color,stroke:_(W.id)?"#22c55e":"#374151",strokeWidth:_(W.id)?2:1}},null,8,["config"])):W.shape==="ellipse"?(y(),ve(u,{key:3,config:{x:W.width*n.scale/2,y:W.height*n.scale/2,radiusX:W.width*n.scale/2,radiusY:W.height*n.scale/2,fill:W.color,stroke:_(W.id)?"#22c55e":"#374151",strokeWidth:_(W.id)?2:1}},null,8,["config"])):W.shape==="l-shape"?(y(),ve(F,{key:4,config:$(W)},null,8,["config"])):H("",!0),A(ue,{config:R(W)},null,8,["config"]),A(ue,{config:{text:`${W.width}cm`,fontSize:10,fill:"#374151",x:W.width*n.scale/2,y:4,offsetX:15}},null,8,["config"]),A(ue,{config:{text:`${W.height}cm`,fontSize:10,fill:"#374151",x:4,y:W.height*n.scale/2,rotation:-90,offsetX:15}},null,8,["config"])]),_:2},1032,["config","onDragstart","onDragmove","onDragend","onClick","onDblclick","onTransformend"]))),128)}}}),Xs=Object.assign(Is,{__name:"CanvasFurnitureLayer"}),Ys=pe({__name:"GroupLayer",props:{groups:{},selectedGroupId:{}},emits:["click","dragstart","dragend"],setup(n,{emit:i}){const l=i;return(c,r)=>{const h=re("v-rect"),k=re("v-text");return y(!0),S(q,null,ge(n.groups,_=>(y(),S(q,{key:_.id},[A(h,{config:{x:_.x,y:_.y,width:_.width,height:_.height,fill:"transparent",stroke:n.selectedGroupId===_.id?"#8b5cf6":_.color,strokeWidth:n.selectedGroupId===_.id?3:2,dash:[8,4],cornerRadius:4,draggable:!_.locked,name:`group-${_.id}`},onClick:b=>l("click",_,b),onDragstart:b=>l("dragstart",b,_),onDragend:b=>l("dragend",b,_)},null,8,["config","onClick","onDragstart","onDragend"]),A(k,{config:{x:_.x,y:_.y-18,text:_.name,fontSize:12,fill:n.selectedGroupId===_.id?"#8b5cf6":_.color,fontStyle:"bold"}},null,8,["config"])],64))),128)}}}),_s=Object.assign(Ys,{__name:"CanvasGroupLayer"}),Ls=pe({__name:"DistanceLayer",props:{distanceLines:{}},setup(n){return(i,l)=>{const c=re("v-line"),r=re("v-text");return y(!0),S(q,null,ge(n.distanceLines,h=>(y(),S(q,{key:h.id},[A(c,{config:{points:h.points,stroke:h.color,strokeWidth:1,dash:[4,4]}},null,8,["config"]),A(r,{config:{text:`${h.distance}cm`,fontSize:11,fill:h.color,fontStyle:"bold",x:h.textX,y:h.textY,offsetX:h.offsetX||0,offsetY:h.offsetY||0}},null,8,["config"])],64))),128)}}}),Rs=Object.assign(Ls,{__name:"CanvasDistanceLayer"});function Ps(n,i){const l=i.x-n.x,c=i.y-n.y;return Math.sqrt(l*l+c*c)}function Ws(n,i){return{id:`measure-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,start:n,end:i,distance:Ps(n,i)}}function Es(n,i){return`${Math.round(n/i)}cm`}const Fs=pe({__name:"MeasureLayer",props:{measurements:{},startPoint:{},currentPoint:{},scale:{}},setup(n){return(i,l)=>{const c=re("v-line"),r=re("v-circle"),h=re("v-text");return y(),S(q,null,[(y(!0),S(q,null,ge(n.measurements,k=>(y(),S(q,{key:k.id},[A(c,{class:"measurement-line",config:{points:[k.start.x,k.start.y,k.end.x,k.end.y],stroke:"#ef4444",strokeWidth:2,dash:[6,4]}},null,8,["config"]),A(r,{config:{x:k.start.x,y:k.start.y,radius:4,fill:"#ef4444"}},null,8,["config"]),A(r,{config:{x:k.end.x,y:k.end.y,radius:4,fill:"#ef4444"}},null,8,["config"]),A(h,{config:{x:(k.start.x+k.end.x)/2,y:(k.start.y+k.end.y)/2-12,text:le(Es)(k.distance,n.scale),fontSize:14,fontStyle:"bold",fill:"#ef4444",offsetX:20}},null,8,["config"])],64))),128)),n.startPoint&&n.currentPoint?(y(),S(q,{key:0},[A(c,{config:{points:[n.startPoint.x,n.startPoint.y,n.currentPoint.x,n.currentPoint.y],stroke:"#f97316",strokeWidth:2,dash:[6,4]}},null,8,["config"]),A(r,{config:{x:n.startPoint.x,y:n.startPoint.y,radius:4,fill:"#f97316"}},null,8,["config"]),A(r,{config:{x:n.currentPoint.x,y:n.currentPoint.y,radius:4,fill:"#f97316"}},null,8,["config"])],64)):n.startPoint?(y(),ve(r,{key:1,config:{x:n.startPoint.x,y:n.startPoint.y,radius:5,fill:"#f97316",stroke:"#ffffff",strokeWidth:2}},null,8,["config"])):H("",!0)],64)}}}),zs=Object.assign(Fs,{__name:"CanvasMeasureLayer"}),js=[0,90,180,270];function Ts(n){const i=[];return(!n.name||n.name.trim()==="")&&i.push("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"),n.width<=0&&i.push("ë„ˆë¹„ëŠ” ì–‘ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤"),n.height<=0&&i.push("ë†’ì´ëŠ” ì–‘ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤"),js.includes(n.rotation)||i.push("íšŒì „ì€ 0, 90, 180, 270 ì¤‘ í•˜ë‚˜ì—¬ì•¼ í•©ë‹ˆë‹¤"),{valid:i.length===0,errors:i}}function Us(n){const i=[];return n.width<=0&&i.push("ë„ˆë¹„ëŠ” ì–‘ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤"),{valid:i.length===0,errors:i}}function Bs(n,i){return{...n,name:i.name,width:i.width,height:i.height,color:i.color,rotation:i.rotation,shape:i.shape,lShapeDirection:i.lShapeDirection,lShapeRatio:i.lShapeRatio}}function As(n,i){return{...n,width:i.width,openDirection:i.openDirection,hingeSide:i.hingeSide}}function Gs(n={}){const{maxHistory:i=50}=n,l=qt([]),c=qt([]),r=ne(()=>l.value.length>1),h=ne(()=>c.value.length>0),k=ne(()=>{if(l.value.length!==0)return l.value[l.value.length-1]}),_=X=>JSON.parse(JSON.stringify(X));return{canUndo:r,canRedo:h,currentState:k,pushState:X=>{const M=[...l.value,_(X)];M.length>i&&M.shift(),l.value=M,c.value=[]},undo:()=>{if(!r.value)return;const X=[...l.value],M=X.pop();if(M&&(c.value=[...c.value,M]),l.value=X,X.length>0){const v=X[X.length-1];return v!==void 0?_(v):void 0}},redo:()=>{if(!h.value)return;const X=[...c.value],M=X.pop();if(M)return l.value=[...l.value,M],c.value=X,_(M)},clear:()=>{l.value=[],c.value=[]}}}const Os=["image/png","image/jpeg","image/gif","image/webp"],Vs=10*1024*1024;function Hs(n){const i=[];return Os.includes(n.type)||i.push("ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. (PNG, JPEG, GIF, WebP)"),n.size>Vs&&i.push("íŒŒì¼ í¬ê¸°ê°€ 10MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤."),{valid:i.length===0,errors:i}}function Ns(n){return new Promise((i,l)=>{const c=new FileReader;c.onload=()=>i(c.result),c.onerror=()=>l(new Error("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")),c.readAsDataURL(n)})}function Ks(n,i){return{width:n,height:i,aspectRatio:n/i}}function Js(n){return new Promise((i,l)=>{const c=new Image;c.onload=()=>{i(Ks(c.width,c.height))},c.onerror=()=>l(new Error("ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")),c.src=n})}function Zs(n,i,l,c){return{id:`floor-plan-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,dataUrl:n,width:i,height:l,originalName:c,x:0,y:0,scale:1,opacity:.5,locked:!1,zIndex:-1}}async function qs(n){const i=Hs(n);if(!i.valid)throw new Error(i.errors.join(", "));const l=await Ns(n),c=await Js(l);return Zs(l,c.width,c.height,n.name)}function Qs(n){return n.length===0?0:Math.max(...n.map(i=>i.zIndex))+1}function bt(n){return[...n].sort((i,l)=>i.zIndex-l.zIndex)}function ea(n,i){const l=n.find(r=>r.id===i);if(!l)return n;const c=Math.max(...n.map(r=>r.zIndex));return l.zIndex===c?n:n.map(r=>r.id===i?{...r,zIndex:c+1}:r)}function ta(n,i){const l=n.find(r=>r.id===i);if(!l)return n;const c=Math.min(...n.map(r=>r.zIndex));return l.zIndex===c?n:n.map(r=>r.id===i?{...r,zIndex:c-1}:r)}function ll(n,i){const l=n.find(k=>k.id===i);if(!l)return n;const c=bt(n),r=c.findIndex(k=>k.id===i);if(r===c.length-1)return n;const h=c[r+1];return n.map(k=>k.id===i?{...k,zIndex:h.zIndex}:k.id===h.id?{...k,zIndex:l.zIndex}:k)}function ol(n,i){const l=n.find(k=>k.id===i);if(!l)return n;const c=bt(n),r=c.findIndex(k=>k.id===i);if(r===0)return n;const h=c[r-1];return n.map(k=>k.id===i?{...k,zIndex:h.zIndex}:k.id===h.id?{...k,zIndex:l.zIndex}:k)}function la(n,i,l){if(n.length<=1)return n;const c=[...bt(n)].reverse(),r=c.findIndex(b=>b.id===i);if(r===-1||r===l)return n;const h=[...c],[k]=h.splice(r,1);h.splice(l,0,k);const _=h.length-1;return n.map(b=>{const $=h.findIndex(R=>R.id===b.id);return{...b,zIndex:_-$}})}function oa(){return`group-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function na(n,i){const l=n.startX*i,c=n.startY*i,r=n.endX*i,h=n.endY*i,k=n.thickness*i/2,_=Math.min(l,r)-k,b=Math.min(c,h)-k,$=Math.max(l,r)+k,R=Math.max(c,h)+k;return{minX:_,minY:b,maxX:$,maxY:R,width:$-_,height:R-b,centerX:(_+$)/2,centerY:(b+R)/2}}function sa(n){if(n.length===0)return null;let i=1/0,l=1/0,c=-1/0,r=-1/0;for(const h of n)i=Math.min(i,h.minX),l=Math.min(l,h.minY),c=Math.max(c,h.maxX),r=Math.max(r,h.maxY);return{minX:i,minY:l,maxX:c,maxY:r,width:c-i,height:r-l,centerX:(i+c)/2,centerY:(l+r)/2}}function aa(n,i,l={}){return{id:oa(),name:l.name||`ê·¸ë£¹ ${new Date().toLocaleTimeString()}`,members:[...n],x:i.minX,y:i.minY,width:i.width,height:i.height,rotation:0,zIndex:l.zIndex??100,color:l.color||"#8b5cf6",locked:!1,createdAt:Date.now()}}function ia(n){const i=n.endX-n.startX,l=n.endY-n.startY,c=Math.sqrt(i*i+l*l);if(c===0){const b=n.thickness/2;return{left:n.startX-b,right:n.startX+b,top:n.startY-b,bottom:n.startY+b}}const r=-l/c,h=i/c,k=n.thickness/2,_=[{x:n.startX+r*k,y:n.startY+h*k},{x:n.startX-r*k,y:n.startY-h*k},{x:n.endX+r*k,y:n.endY+h*k},{x:n.endX-r*k,y:n.endY-h*k}];return{left:Math.min(..._.map(b=>b.x)),right:Math.max(..._.map(b=>b.x)),top:Math.min(..._.map(b=>b.y)),bottom:Math.max(..._.map(b=>b.y))}}function ra(n,i,l){let c=1/0,r=0;for(const h of i){const k=ia(h);if(l==="left"||l==="right"){if(!!(n.bottom<=k.top||n.top>=k.bottom))continue;if(l==="left"){if(k.right<=n.left){const b=n.left-k.right;b<c&&(c=b,r=k.right)}}else if(k.left>=n.right){const b=k.left-n.right;b<c&&(c=b,r=k.left)}}else{if(!!(n.right<=k.left||n.left>=k.right))continue;if(l==="top"){if(k.bottom<=n.top){const b=n.top-k.bottom;b<c&&(c=b,r=k.bottom)}}else if(k.top>=n.bottom){const b=k.top-n.bottom;b<c&&(c=b,r=k.top)}}}return c===1/0?null:{distance:c,wallEdge:r}}function ua(n,i,l){const c=i.left+i.width,r=i.top+i.height;switch(l){case"left":return{distance:n.left-i.left,wallEdge:i.left};case"right":return{distance:c-n.right,wallEdge:c};case"top":return{distance:n.top-i.top,wallEdge:i.top};case"bottom":return{distance:r-n.bottom,wallEdge:r}}}const da={class:"bg-white rounded-lg shadow-lg p-4 w-72"},ca={class:"space-y-3"},va={class:"flex items-center gap-2"},fa={class:"flex items-center gap-2"},ga=["value"],pa=["value"],ha={class:"block text-xs font-medium text-gray-600 mb-1"},ma={key:1,class:"text-xs text-red-500"},xa={class:"list-disc list-inside"},ya={class:"flex gap-2 mt-4"},ba=pe({__name:"FurnitureEditForm",props:{furniture:{}},emits:["update","delete","close"],setup(n,{emit:i}){const l=n,c=i,r=P({name:l.furniture.name,width:l.furniture.width,height:l.furniture.height,color:l.furniture.color,rotation:l.furniture.rotation,shape:l.furniture.shape||"rect",lShapeDirection:l.furniture.lShapeDirection||"bottom-right",lShapeRatio:l.furniture.lShapeRatio||.5}),h=P([]),k=ne(()=>r.value.shape==="l-shape"),_=[{value:"rect",label:"ì‚¬ê°í˜•"},{value:"circle",label:"ì›í˜•"},{value:"ellipse",label:"íƒ€ì›í˜•"},{value:"l-shape",label:"Lìí˜•"}],b=[{value:"top-left",label:"â†– ì¢Œìƒë‹¨"},{value:"top-right",label:"â†— ìš°ìƒë‹¨"},{value:"bottom-left",label:"â†™ ì¢Œí•˜ë‹¨"},{value:"bottom-right",label:"â†˜ ìš°í•˜ë‹¨"}];Ne(()=>l.furniture,R=>{r.value={name:R.name,width:R.width,height:R.height,color:R.color,rotation:R.rotation,shape:R.shape||"rect",lShapeDirection:R.lShapeDirection||"bottom-right",lShapeRatio:R.lShapeRatio||.5}},{deep:!0});function $(){h.value=[];const R=Ts(r.value);if(!R.valid){h.value=R.errors;return}c("update",{...r.value})}return(R,D)=>(y(),S("div",da,[D[20]||(D[20]=e("h3",{class:"text-sm font-medium text-gray-900 mb-3"},"ğŸ“ ê°€êµ¬ í¸ì§‘",-1)),e("div",ca,[e("div",null,[D[11]||(D[11]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ì´ë¦„",-1)),te(e("input",{"onUpdate:modelValue":D[0]||(D[0]=X=>r.value.name=X),type:"text",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ce,r.value.name]])]),e("div",null,[D[14]||(D[14]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"í¬ê¸°",-1)),e("div",va,[te(e("input",{"onUpdate:modelValue":D[1]||(D[1]=X=>r.value.width=X),type:"number",min:"1",class:"w-20 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ce,r.value.width,void 0,{number:!0}]]),D[12]||(D[12]=e("span",{class:"text-gray-500 text-sm"},"Ã—",-1)),te(e("input",{"onUpdate:modelValue":D[2]||(D[2]=X=>r.value.height=X),type:"number",min:"1",class:"w-20 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ce,r.value.height,void 0,{number:!0}]]),D[13]||(D[13]=e("span",{class:"text-gray-500 text-sm"},"cm",-1))])]),e("div",null,[D[15]||(D[15]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ìƒ‰ìƒ",-1)),e("div",fa,[te(e("input",{"onUpdate:modelValue":D[3]||(D[3]=X=>r.value.color=X),type:"color",class:"w-8 h-8 rounded cursor-pointer border border-gray-300"},null,512),[[ce,r.value.color]]),te(e("input",{"onUpdate:modelValue":D[4]||(D[4]=X=>r.value.color=X),type:"text",class:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ce,r.value.color]])])]),e("div",null,[D[17]||(D[17]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"íšŒì „",-1)),te(e("select",{"onUpdate:modelValue":D[5]||(D[5]=X=>r.value.rotation=X),class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[...D[16]||(D[16]=[e("option",{value:0},"0Â°",-1),e("option",{value:90},"90Â°",-1),e("option",{value:180},"180Â°",-1),e("option",{value:270},"270Â°",-1)])],512),[[yt,r.value.rotation,void 0,{number:!0}]])]),e("div",null,[D[18]||(D[18]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ëª¨ì–‘",-1)),te(e("select",{"onUpdate:modelValue":D[6]||(D[6]=X=>r.value.shape=X),class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[(y(),S(q,null,ge(_,X=>e("option",{key:X.value,value:X.value},U(X.label),9,ga)),64))],512),[[yt,r.value.shape]])]),k.value?(y(),S(q,{key:0},[e("div",null,[D[19]||(D[19]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Lì ë°©í–¥",-1)),te(e("select",{"onUpdate:modelValue":D[7]||(D[7]=X=>r.value.lShapeDirection=X),class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[(y(),S(q,null,ge(b,X=>e("option",{key:X.value,value:X.value},U(X.label),9,pa)),64))],512),[[yt,r.value.lShapeDirection]])]),e("div",null,[e("label",ha,"Lì ë¹„ìœ¨ ("+U(Math.round((r.value.lShapeRatio||.5)*100))+"%)",1),te(e("input",{"onUpdate:modelValue":D[8]||(D[8]=X=>r.value.lShapeRatio=X),type:"range",min:"0.3",max:"0.7",step:"0.1",class:"w-full"},null,512),[[ce,r.value.lShapeRatio,void 0,{number:!0}]])])],64)):H("",!0),h.value.length>0?(y(),S("div",ma,[e("ul",xa,[(y(!0),S(q,null,ge(h.value,X=>(y(),S("li",{key:X},U(X),1))),128))])])):H("",!0)]),e("div",ya,[e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors",onClick:D[9]||(D[9]=X=>R.$emit("close"))}," ë‹«ê¸° "),e("button",{class:"px-3 py-1.5 text-sm bg-red-500 text-white rounded hover:bg-red-600 transition-colors",onClick:D[10]||(D[10]=X=>R.$emit("delete"))}," ì‚­ì œ "),e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",onClick:$}," ì ìš© ")])]))}}),wa=Object.assign(ba,{__name:"EditorFurnitureEditForm"}),ka={class:"bg-white rounded-lg shadow-lg p-4 w-72"},Sa={class:"space-y-3"},Da={class:"flex gap-4"},Ma={class:"flex items-center gap-1.5 cursor-pointer"},Ca={class:"flex items-center gap-1.5 cursor-pointer"},$a={class:"flex gap-4"},Ia={class:"flex items-center gap-1.5 cursor-pointer"},Xa={class:"flex items-center gap-1.5 cursor-pointer"},Ya={key:0,class:"text-xs text-red-500"},_a={class:"list-disc list-inside"},La={class:"flex gap-2 mt-4"},Ra=pe({__name:"DoorEditForm",props:{door:{}},emits:["update","delete","close"],setup(n,{emit:i}){const l=n,c=i,r=P({width:l.door.width,openDirection:l.door.openDirection,hingeSide:l.door.hingeSide}),h=P([]);Ne(()=>l.door,_=>{r.value={width:_.width,openDirection:_.openDirection,hingeSide:_.hingeSide}},{deep:!0});function k(){h.value=[];const _=Us(r.value);if(!_.valid){h.value=_.errors;return}c("update",{...r.value})}return(_,b)=>(y(),S("div",ka,[b[14]||(b[14]=e("h3",{class:"text-sm font-medium text-gray-900 mb-3"},"ğŸšª ë¬¸ í¸ì§‘",-1)),e("div",Sa,[e("div",null,[b[7]||(b[7]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ë„ˆë¹„ (cm)",-1)),te(e("input",{"onUpdate:modelValue":b[0]||(b[0]=$=>r.value.width=$),type:"number",min:"1",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ce,r.value.width,void 0,{number:!0}]])]),e("div",null,[b[10]||(b[10]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ì—´ë¦¼ ë°©í–¥",-1)),e("div",Da,[e("label",Ma,[te(e("input",{"onUpdate:modelValue":b[1]||(b[1]=$=>r.value.openDirection=$),type:"radio",value:"inside",class:"text-blue-500 focus:ring-blue-500"},null,512),[[lt,r.value.openDirection]]),b[8]||(b[8]=e("span",{class:"text-sm text-gray-700"},"ì•ˆìª½",-1))]),e("label",Ca,[te(e("input",{"onUpdate:modelValue":b[2]||(b[2]=$=>r.value.openDirection=$),type:"radio",value:"outside",class:"text-blue-500 focus:ring-blue-500"},null,512),[[lt,r.value.openDirection]]),b[9]||(b[9]=e("span",{class:"text-sm text-gray-700"},"ë°”ê¹¥ìª½",-1))])])]),e("div",null,[b[13]||(b[13]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ê²½ì²© ìœ„ì¹˜",-1)),e("div",$a,[e("label",Ia,[te(e("input",{"onUpdate:modelValue":b[3]||(b[3]=$=>r.value.hingeSide=$),type:"radio",value:"left",class:"text-blue-500 focus:ring-blue-500"},null,512),[[lt,r.value.hingeSide]]),b[11]||(b[11]=e("span",{class:"text-sm text-gray-700"},"ì™¼ìª½",-1))]),e("label",Xa,[te(e("input",{"onUpdate:modelValue":b[4]||(b[4]=$=>r.value.hingeSide=$),type:"radio",value:"right",class:"text-blue-500 focus:ring-blue-500"},null,512),[[lt,r.value.hingeSide]]),b[12]||(b[12]=e("span",{class:"text-sm text-gray-700"},"ì˜¤ë¥¸ìª½",-1))])])]),h.value.length>0?(y(),S("div",Ya,[e("ul",_a,[(y(!0),S(q,null,ge(h.value,$=>(y(),S("li",{key:$},U($),1))),128))])])):H("",!0)]),e("div",La,[e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors",onClick:b[5]||(b[5]=$=>_.$emit("close"))}," ë‹«ê¸° "),e("button",{class:"px-3 py-1.5 text-sm bg-red-500 text-white rounded hover:bg-red-600 transition-colors",onClick:b[6]||(b[6]=$=>_.$emit("delete"))}," ì‚­ì œ "),e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",onClick:k}," ì ìš© ")])]))}}),Pa=Object.assign(Ra,{__name:"EditorDoorEditForm"}),Wa={class:"bg-white rounded-lg shadow-lg p-4 w-80"},Ea={class:"space-y-3"},Fa={class:"px-2 py-1.5 text-sm bg-gray-100 rounded text-gray-700"},za={class:"flex gap-4"},ja={class:"flex items-center gap-1.5 cursor-pointer"},Ta={class:"flex items-center gap-1.5 cursor-pointer"},Ua={class:"flex gap-2"},Ba=["title","onClick"],Aa={key:0},Ga={class:"block text-xs font-medium text-gray-600 mb-1"},Oa={class:"max-h-24 overflow-y-auto border rounded p-2 space-y-1"},Va=["value"],Ha={class:"text-xs text-gray-600"},Na={class:"text-gray-400"},Ka={key:0,class:"mt-2 flex gap-2"},Ja={key:1,class:"text-xs text-red-500"},Za={class:"list-disc list-inside"},qa={class:"flex gap-2 mt-4"},Qa=pe({__name:"WallEditForm",props:{wall:{},allWalls:{}},emits:["update","delete","close","merge","join"],setup(n,{emit:i}){const l=n,c=i,r=P({thickness:l.wall.thickness,isExterior:l.wall.isExterior,color:l.wall.color}),h=P([]),k=P([]),_=[{value:ut.interior,label:"ë‚´ë²½ (íšŒìƒ‰)"},{value:ut.exterior,label:"ì™¸ë²½ (ì§„íšŒìƒ‰)"},{value:"#78716c",label:"ì½˜í¬ë¦¬íŠ¸"},{value:"#a16207",label:"ë‚˜ë¬´"},{value:"#dc2626",label:"ë¹¨ê°•"},{value:"#2563eb",label:"íŒŒë‘"}],b=ne(()=>Oe(l.wall)),$=ne(()=>{const M=[],v=l.wall;for(const u of l.allWalls){if(u.id===v.id)continue;const F=v.startX,ue=v.startY,ae=v.endX,W=v.endY,se=(Xe,De,Me,Ce)=>Math.sqrt((Xe-Me)**2+(De-Ce)**2);se(ae,W,u.startX,u.startY)<=pt?M.push({id:u.id,length:Oe(u),connectionPoint:"end"}):se(ae,W,u.endX,u.endY)<=pt?M.push({id:u.id,length:Oe(u),connectionPoint:"end"}):se(F,ue,u.startX,u.startY)<=pt?M.push({id:u.id,length:Oe(u),connectionPoint:"start"}):se(F,ue,u.endX,u.endY)<=pt&&M.push({id:u.id,length:Oe(u),connectionPoint:"start"})}return M});Ne(()=>l.wall,M=>{r.value={thickness:M.thickness,isExterior:M.isExterior,color:M.color},k.value=[]},{deep:!0}),Ne(()=>r.value.isExterior,M=>{r.value.color=M?ut.exterior:ut.interior});function R(){if(h.value=[],r.value.thickness<5){h.value.push("ë‘ê»˜ëŠ” 5cm ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");return}if(r.value.thickness>50){h.value.push("ë‘ê»˜ëŠ” 50cm ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");return}c("update",{...r.value})}function D(){k.value.length!==0&&c("merge",[...k.value])}function X(){k.value.length!==0&&c("join",[...k.value])}return(M,v)=>(y(),S("div",Wa,[v[12]||(v[12]=e("h3",{class:"text-sm font-medium text-gray-900 mb-3"},"ğŸ§± ë²½ì²´ í¸ì§‘",-1)),e("div",Ea,[e("div",null,[v[6]||(v[6]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ê¸¸ì´",-1)),e("div",Fa,U(Math.round(b.value))+" cm ",1)]),e("div",null,[v[7]||(v[7]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ë‘ê»˜ (cm)",-1)),te(e("input",{"onUpdate:modelValue":v[0]||(v[0]=u=>r.value.thickness=u),type:"number",min:"5",max:"50",step:"1",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ce,r.value.thickness,void 0,{number:!0}]])]),e("div",null,[v[10]||(v[10]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ë²½ì²´ ì¢…ë¥˜",-1)),e("div",za,[e("label",ja,[te(e("input",{"onUpdate:modelValue":v[1]||(v[1]=u=>r.value.isExterior=u),type:"radio",value:!1,class:"text-blue-500 focus:ring-blue-500"},null,512),[[lt,r.value.isExterior]]),v[8]||(v[8]=e("span",{class:"text-sm text-gray-700"},"ë‚´ë²½",-1))]),e("label",Ta,[te(e("input",{"onUpdate:modelValue":v[2]||(v[2]=u=>r.value.isExterior=u),type:"radio",value:!0,class:"text-blue-500 focus:ring-blue-500"},null,512),[[lt,r.value.isExterior]]),v[9]||(v[9]=e("span",{class:"text-sm text-gray-700"},"ì™¸ë²½",-1))])])]),e("div",null,[v[11]||(v[11]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"ìƒ‰ìƒ",-1)),e("div",Ua,[(y(),S(q,null,ge(_,u=>e("button",{key:u.value,class:xe(["w-8 h-8 rounded border-2 transition-all",r.value.color===u.value?"border-blue-500 scale-110":"border-gray-300"]),style:Ge({backgroundColor:u.value}),title:u.label,onClick:F=>r.value.color=u.value},null,14,Ba)),64))])]),$.value.length>0?(y(),S("div",Aa,[e("label",Ga," ì—°ê²° ê°€ëŠ¥í•œ ë²½ì²´ ("+U($.value.length)+"ê°œ) ",1),e("div",Oa,[(y(!0),S(q,null,ge($.value,u=>(y(),S("label",{key:u.id,class:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-1 rounded"},[te(e("input",{"onUpdate:modelValue":v[3]||(v[3]=F=>k.value=F),type:"checkbox",value:u.id,class:"text-green-500 focus:ring-green-500"},null,8,Va),[[Yo,k.value]]),e("span",Ha,[Pe(U(Math.round(u.length))+"cm ",1),e("span",Na,"("+U(u.connectionPoint)+")",1)])]))),128))]),k.value.length>0?(y(),S("div",Ka,[e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-green-500 text-white rounded hover:bg-green-600 transition-colors",onClick:D,title:"ì„ íƒí•œ ë²½ì²´ì˜ ëì ì„ í˜„ì¬ ë²½ì²´ì— ìŠ¤ëƒ…"}," ëì  ì—°ê²° "),e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",onClick:X,title:"ì„ íƒí•œ ë²½ì²´ë“¤ì„ í•˜ë‚˜ë¡œ ê²°í•©"}," ê²°í•© ")])):H("",!0)])):H("",!0),h.value.length>0?(y(),S("div",Ja,[e("ul",Za,[(y(!0),S(q,null,ge(h.value,u=>(y(),S("li",{key:u},U(u),1))),128))])])):H("",!0)]),e("div",qa,[e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors",onClick:v[4]||(v[4]=u=>M.$emit("close"))}," ë‹«ê¸° "),e("button",{class:"px-3 py-1.5 text-sm bg-red-500 text-white rounded hover:bg-red-600 transition-colors",onClick:v[5]||(v[5]=u=>M.$emit("delete"))}," ì‚­ì œ "),e("button",{class:"flex-1 px-3 py-1.5 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",onClick:R}," ì ìš© ")])]))}}),ei=Object.assign(Qa,{__name:"EditorWallEditForm"}),ti={key:0,class:"absolute top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow"},li={key:0,class:"ml-2 text-sm opacity-75"},oi={key:1,class:"ml-2 text-sm opacity-75"},ni={key:1,class:"absolute top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow"},si={key:0,class:"ml-2 text-sm opacity-75"},ai={key:1,class:"ml-2 text-sm opacity-75"},ii={class:"absolute bottom-4 right-4 flex flex-col gap-2"},ri=["disabled"],ui=["disabled"],di={key:2,class:"absolute bottom-4 left-4 bg-white rounded-lg shadow-lg p-4 w-64"},ci={class:"flex items-center justify-between mb-3"},vi={class:"flex gap-1"},fi={class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},gi={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"},pi={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"},hi={class:"space-y-3"},mi={class:"block text-xs text-gray-500 mb-1"},xi={class:"block text-xs text-gray-500 mb-1"},yi={key:3,class:"absolute top-4 left-4"},bi={key:4,class:"absolute top-4 left-4"},wi={key:5,class:"absolute top-4 left-4"},ki={key:6,class:"absolute top-4 left-4"},Si={key:7,class:"absolute bottom-4 left-4"},Di={key:8,class:"absolute top-4 left-4"},Mi={class:"bg-white rounded-lg shadow-lg p-4 w-72"},Ci={class:"space-y-3"},$i={class:"block text-sm text-gray-600 mb-1"},Ii={key:0,class:"text-red-500 text-sm"},Xi={key:9,class:"absolute inset-0 bg-black/50 flex items-center justify-center"},Yi={class:"bg-white rounded-xl p-6 w-80 shadow-xl"},_i={class:"space-y-4"},Li={class:"flex gap-2"},Ri={key:10,class:"absolute inset-0 bg-black/50 flex items-center justify-center"},Pi={class:"bg-white rounded-xl p-6 w-80 shadow-xl"},Wi={class:"space-y-4"},Ei={class:"block text-sm text-gray-600 mb-1"},Fi={class:"flex gap-2"},zi=2,ji="#3b82f6",xt="#f97316",nl=15,Ti=20,Ui=500,Bi=pe({__name:"FloorPlanCanvas",setup(n,{expose:i}){const l=ne(()=>u.value?.widthCm&&u.value.widthCm>0?u.value.width/u.value.widthCm:zi),c=t=>{const o=t.width*l.value,a=t.height*l.value,s=t.lShapeRatioW??t.lShapeRatio??.5,d=t.lShapeRatioH??t.lShapeRatio??.5,x=t.lShapeDirection||"bottom-right",p=o*s,f=a*d;let g=0,I=0;switch(x){case"bottom-right":g=t.x+p,I=t.y+f/2;break;case"bottom-left":g=t.x+o-p,I=t.y+f/2;break;case"top-right":g=t.x+o-p,I=t.y+a-f/2;break;case"top-left":g=t.x+p,I=t.y+a-f/2;break}return{x:g-5,y:I-8,width:10,height:16,fill:"#3b82f6",stroke:"#ffffff",strokeWidth:2,cornerRadius:3,draggable:!0,hitStrokeWidth:10}},r=t=>{const o=t.width*l.value,a=t.height*l.value,s=t.lShapeRatioW??t.lShapeRatio??.5,d=t.lShapeRatioH??t.lShapeRatio??.5,x=t.lShapeDirection||"bottom-right",p=o*s,f=a*d;let g=0,I=0;switch(x){case"bottom-right":g=t.x+p/2,I=t.y+f;break;case"bottom-left":g=t.x+o-p/2,I=t.y+f;break;case"top-right":g=t.x+o-p/2,I=t.y+a-f;break;case"top-left":g=t.x+p/2,I=t.y+a-f;break}return{x:g-8,y:I-5,width:16,height:10,fill:"#3b82f6",stroke:"#ffffff",strokeWidth:2,cornerRadius:3,draggable:!0,hitStrokeWidth:10}},h=(t,o)=>{const a=o.target,s=t.width*l.value,d=t.lShapeDirection||"bottom-right",p=a.x()+5-t.x;let f=.5;switch(d){case"bottom-right":case"top-left":f=p/s;break;case"bottom-left":case"top-right":f=(s-p)/s;break}t.lShapeRatioW=Math.max(.2,Math.min(.8,Math.round(f*100)/100))},k=(t,o)=>{const a=o.target,s=t.height*l.value,d=t.lShapeDirection||"bottom-right",p=a.y()+5-t.y;let f=.5;switch(d){case"bottom-right":case"bottom-left":f=p/s;break;case"top-right":case"top-left":f=(s-p)/s;break}t.lShapeRatioH=Math.max(.2,Math.min(.8,Math.round(f*100)/100))},_=P(null),b=P(null),$=P(null),R=P(null),D=P(null),X=P(null),M=()=>X.value?.furnitureRefs||new Map,v=P({width:800,height:600,x:0,y:0,scaleX:1,scaleY:1}),u=P(null),F=P(!1),ue=P(null),ae=P(!1),W=P(!1),se=P(400),Xe=P(300),De=P(400),Me=P(300),Ce=P(1),Ie=P(""),Ye=P(!1),V=P("bottom"),G=P(100),w=P(90),Y=P([]),E=P(null);ne(()=>bt(Y.value));const ie=P([]),m=P(null),C=P(!1),L=P(!1),j=P(null),oe=P(null),de=P([]),J=P(null),_t=P(null),dt=P(null),ot=P(null);Ne(J,t=>{if(t){const o=new Image;o.onload=()=>{console.log("Image loaded:",o.width,o.height),dt.value=o},o.onerror=a=>{console.error("Image load error:",a)},o.src=t.dataUrl}else dt.value=null},{immediate:!0});const z=P([]),N=P(null),ke=P(!1),Ke=P(!1);ne(()=>{if(!Ke.value||z.value.length===0)return[];const t=sl(z.value),o=[];for(const a of t){const s=al(a);s&&o.push(s)}return o});const qe=P([]),ye=P(null),il=t=>{ye.value=t,E.value=null,N.value=null,m.value=null,F.value=!1},rl=t=>{const o=[];for(const x of t)if(x.type==="furniture"){const p=Y.value.find(f=>f.id===x.id);if(p){const f=Ve(p.x,p.y,p);o.push({minX:f.left,minY:f.top,maxX:f.right,maxY:f.bottom,width:f.width,height:f.height,centerX:(f.left+f.right)/2,centerY:(f.top+f.bottom)/2})}}else if(x.type==="wall"){const p=z.value.find(f=>f.id===x.id);p&&o.push(na(p,l.value))}else x.type==="room"&&u.value&&u.value.id===x.id&&o.push({minX:u.value.x,minY:u.value.y,maxX:u.value.x+u.value.width,maxY:u.value.y+u.value.height,width:u.value.width,height:u.value.height,centerX:u.value.x+u.value.width/2,centerY:u.value.y+u.value.height/2});const a=sa(o);if(!a)return;const s=Math.max(...qe.value.map(x=>x.zIndex),...Y.value.map(x=>x.zIndex),...z.value.map(x=>x.zIndex),0),d=aa(t,a,{zIndex:s+1});qe.value.push(d),ye.value=d,Q()},ul=t=>{const o=qe.value.findIndex(a=>a.id===t);o!==-1&&(qe.value.splice(o,1),ye.value?.id===t&&(ye.value=null),Q())},dl=(t,o)=>{me.value=!1,o.evt?.stopPropagation?.(),ye.value=t,E.value=null,N.value=null,m.value=null,F.value=!1};let Lt=0,Rt=0;const cl=(t,o)=>{const a=t.target,d=a.getStage().getPointerPosition(),x=t.evt?.button;if(Fe.value||x===1||x===2){me.value=!0,Ue.value={x:d.x,y:d.y},t.evt?.preventDefault(),a.stopDrag();return}Lt=o.x,Rt=o.y},vl=(t,o)=>{const a=t.target.x(),s=t.target.y(),d=a-Lt,x=s-Rt;o.x=a,o.y=s;for(const p of o.members)if(p.type==="furniture"){const f=Y.value.find(g=>g.id===p.id);f&&(f.x+=d,f.y+=x)}else if(p.type==="wall"){const f=z.value.find(g=>g.id===p.id);f&&(f.startX+=d/l.value,f.startY+=x/l.value,f.endX+=d/l.value,f.endY+=x/l.value)}else p.type==="room"&&u.value&&u.value.id===p.id&&(u.value.x+=d,u.value.y+=x,z.value=el(z.value,u.value,l.value));Q()},he=P([]),ct=(t,o)=>{const a=he.value.findIndex(s=>s.id===t&&s.type===o);a!==-1?he.value.splice(a,1):he.value.push({id:t,type:o})},nt=()=>{he.value=[]},Pt=(t,o)=>he.value.some(a=>a.id===t&&a.type===o),fl=ne(()=>he.value.filter(t=>t.type==="furniture").map(t=>t.id)),gl=ne(()=>he.value.filter(t=>t.type==="door").map(t=>t.id)),pl=ne(()=>he.value.filter(t=>t.type==="wall").map(t=>t.id)),we=P(null),be=P(null),_e=P(null),Ee=P(!1),Je=Gs({maxHistory:50}),st=P(!1),Q=()=>{st.value||Je.pushState({room:u.value,furnitureList:Y.value,doorList:ie.value,wallList:z.value})},wt=()=>{const t=Je.undo();t&&(st.value=!0,u.value=t.room,Y.value=t.furnitureList,ie.value=t.doorList,z.value=t.wallList||[],E.value=null,m.value=null,N.value=null,He(()=>{st.value=!1}))},kt=()=>{const t=Je.redo();t&&(st.value=!0,u.value=t.room,Y.value=t.furnitureList,ie.value=t.doorList,z.value=t.wallList||[],E.value=null,m.value=null,N.value=null,He(()=>{st.value=!1}))},me=P(!1),Ue=P({x:0,y:0}),Fe=P(!1),at=P(!1),Qe=P(null),Le=P(null),St=(t,o)=>!(t.x+t.width<o.x||o.x+o.width<t.x||t.y+t.height<o.y||o.y+o.height<t.y),hl=t=>{const o=t.startX*l.value,a=t.startY*l.value,s=t.endX*l.value,d=t.endY*l.value,x=t.thickness*l.value/2;return{x:Math.min(o,s)-x,y:Math.min(a,d)-x,width:Math.abs(s-o)+t.thickness*l.value,height:Math.abs(d-a)+t.thickness*l.value}};ne(()=>{const t=[],{x:a,y:s,scaleX:d,width:x,height:p}=v.value,f=-a/d,g=-s/d,I=(x-a)/d,T=(p-s)/d,K=Math.floor(f/50)*50,B=Math.ceil(I/50)*50,Se=Math.floor(g/50)*50,O=Math.ceil(T/50)*50;for(let Z=K;Z<=B;Z+=50){const ee=Z*d+a;t.push({id:`v-${Z}`,points:[ee,0,ee,p],stroke:Z===0?"#9ca3af":"#d1d5db",strokeWidth:Z===0?1:.5})}for(let Z=Se;Z<=O;Z+=50){const ee=Z*d+s;t.push({id:`h-${Z}`,points:[0,ee,x,ee],stroke:Z===0?"#9ca3af":"#d1d5db",strokeWidth:Z===0?1:.5})}return t});const ml=(t,o,a)=>z.value.map(s=>({startX:s.startX-t/a,startY:s.startY-o/a,endX:s.endX-t/a,endY:s.endY-o/a,thickness:s.thickness})),xl=ne(()=>{if(!E.value||!u.value)return[];const t=[],o=E.value,a=u.value,s=Ve(o.x,o.y,o),d=a.widthCm&&a.widthCm>0?a.width/a.widthCm:l.value,x={left:(s.left-a.x)/d,right:(s.right-a.x)/d,top:(s.top-a.y)/d,bottom:(s.bottom-a.y)/d},p=ml(a.x,a.y,d),f=["left","right","top","bottom"],g=a.widthCm||a.width/l.value,I=a.heightCm||a.height/l.value,T={left:0,top:0,width:g,height:I};for(const K of f){const B=ra(x,p,K),Se=ua(x,T,K);let O=Se,Z=ji;if(B&&B.distance>=0&&B.distance<Se.distance&&(O=B),O&&O.distance>0){const ee=(s.top+s.bottom)/2,Re=(s.left+s.right)/2,et=O.distance*d;if(K==="left"){const Ae=a.x+O.wallEdge*d;t.push({id:"wall-left",points:[Ae,ee,s.left,ee],distance:Math.round(O.distance),textX:Ae+et/2,textY:ee-8,offsetX:12,color:Z})}else if(K==="right"){const Ae=a.x+O.wallEdge*d;t.push({id:"wall-right",points:[s.right,ee,Ae,ee],distance:Math.round(O.distance),textX:s.right+et/2,textY:ee-8,offsetX:12,color:Z})}else if(K==="top"){const Ae=a.y+O.wallEdge*d;t.push({id:"wall-top",points:[Re,Ae,Re,s.top],distance:Math.round(O.distance),textX:Re+4,textY:Ae+et/2,offsetY:5,color:Z})}else if(K==="bottom"){const Ae=a.y+O.wallEdge*d;t.push({id:"wall-bottom",points:[Re,s.bottom,Re,Ae],distance:Math.round(O.distance),textX:Re+4,textY:s.bottom+et/2,offsetY:5,color:Z})}}}for(const K of Y.value){if(K.id===o.id)continue;const B=Ve(K.x,K.y,K);if(!(s.bottom<=B.top||s.top>=B.bottom)){if(B.left>s.right){const Z=B.left-s.right,ee=Math.max(s.top,B.top)+(Math.min(s.bottom,B.bottom)-Math.max(s.top,B.top))/2;t.push({id:`furniture-right-${K.id}`,points:[s.right,ee,B.left,ee],distance:Math.round(Z/l.value),textX:s.right+Z/2,textY:ee-8,offsetX:12,color:xt})}if(B.right<s.left){const Z=s.left-B.right,ee=Math.max(s.top,B.top)+(Math.min(s.bottom,B.bottom)-Math.max(s.top,B.top))/2;t.push({id:`furniture-left-${K.id}`,points:[B.right,ee,s.left,ee],distance:Math.round(Z/l.value),textX:B.right+Z/2,textY:ee-8,offsetX:12,color:xt})}}if(!(s.right<=B.left||s.left>=B.right)){if(B.top>s.bottom){const Z=B.top-s.bottom,ee=Math.max(s.left,B.left)+(Math.min(s.right,B.right)-Math.max(s.left,B.left))/2;t.push({id:`furniture-bottom-${K.id}`,points:[ee,s.bottom,ee,B.top],distance:Math.round(Z/l.value),textX:ee+4,textY:s.bottom+Z/2,offsetY:5,color:xt})}if(B.bottom<s.top){const Z=s.top-B.bottom,ee=Math.max(s.left,B.left)+(Math.min(s.right,B.right)-Math.max(s.left,B.left))/2;t.push({id:`furniture-top-${K.id}`,points:[ee,B.bottom,ee,s.top],distance:Math.round(Z/l.value),textX:ee+4,textY:B.bottom+Z/2,offsetY:5,color:xt})}}}return t}),yl=()=>{const t=Math.min(v.value.scaleX*1.2,3);v.value.scaleX=t,v.value.scaleY=t},bl=()=>{const t=Math.max(v.value.scaleX/1.2,.3);v.value.scaleX=t,v.value.scaleY=t},wl=t=>{t.evt.preventDefault();const o=1.1,a=t.target.getStage(),s=v.value.scaleX,d=a.getPointerPosition(),x={x:(d.x-v.value.x)/s,y:(d.y-v.value.y)/s},f=(t.evt.deltaY>0?-1:1)>0?s*o:s/o,g=Math.max(.3,Math.min(3,f));v.value.scaleX=g,v.value.scaleY=g,v.value.x=d.x-x.x*g,v.value.y=d.y-x.y*g},kl=t=>{if(L.value){Ht(t);return}if(ke.value){const x=t.target.getStage().getPointerPosition(),p=(x.x-v.value.x)/v.value.scaleX,f=(x.y-v.value.y)/v.value.scaleY,g=rt(p/l.value,f/l.value,z.value);g.snapped?be.value={x:g.x*l.value,y:g.y*l.value}:be.value={x:p,y:f};return}const a=t.target.getStage().getPointerPosition(),s=t.evt?.button;if(s===1||s===2||Fe.value){me.value=!0,Ue.value={x:a.x,y:a.y},t.evt?.preventDefault();return}if(t.target===t.target.getStage()&&(s===0||s===void 0)){const d=(a.x-v.value.x)/v.value.scaleX,x=(a.y-v.value.y)/v.value.scaleY;at.value=!0,Qe.value={x:d,y:x},Le.value={x:d,y:x,width:0,height:0},t.evt?.shiftKey||(E.value=null,m.value=null,N.value=null,ye.value=null,F.value=!1,C.value=!1,W.value=!1,nt(),ze())}},Sl=t=>{if(L.value){Ht(t);return}if(ke.value)return;const a=t.target.getStage().getPointerPosition(),s=t.evt?.button;if(Fe.value||s===1||s===2){me.value=!0,Ue.value={x:a.x,y:a.y},t.evt?.preventDefault(),t.cancelBubble=!0;return}t.cancelBubble=!0},Dl=()=>{me.value=!1,!ke.value&&(E.value=null,m.value=null,ye.value=null,C.value=!1,F.value=!0,ze(),He(()=>{if(ue.value&&D.value?.roomRectRef){const t=ue.value.getNode(),o=D.value.roomRectRef.getNode();t.nodes([o]),t.getLayer()?.batchDraw()}}))},Ml=(t,o)=>{const a=100*l.value;return o.width<a||o.height<a?t:o},Cl=t=>{if(!u.value)return;const o=t.target,a=o.scaleX(),s=o.scaleY();u.value.x=o.x(),u.value.y=o.y(),u.value.width=Math.round(o.width()*a),u.value.height=Math.round(o.height()*s),o.scaleX(1),o.scaleY(1),z.value=el(z.value,u.value,l.value),Q()},Wt=()=>{u.value&&(De.value=u.value.widthCm??Math.round(u.value.width),Me.value=u.value.heightCm??Math.round(u.value.height),Ce.value=u.value.opacity,Ie.value="",W.value=!0,F.value=!0)},Dt=()=>{W.value=!1,Ie.value=""},$l=()=>{if(u.value){if(De.value<=0||Me.value<=0){Ie.value="í¬ê¸°ëŠ” 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.";return}u.value.widthCm=De.value,u.value.heightCm=Me.value,u.value.opacity=Ce.value,Ie.value="",W.value=!1,Q()}},Il=t=>{u.value&&(Object.assign(u.value,t),Q())},Xl=(t,o)=>{const a=z.value.findIndex(s=>s.id===t);if(a!==-1){const s=z.value[a];if(s){const d={...s,...o};z.value[a]=d,N.value?.id===t&&(N.value=d),Q()}}},Yl=t=>{u.value&&(z.value=z.value.map(o=>o.roomId===u.value?.id?{...o,thickness:t}:o),Q())},_l=t=>{if(L.value&&yo(t),ke.value&&be.value){const x=t.target.getStage().getPointerPosition();let p=(x.x-v.value.x)/v.value.scaleX,f=(x.y-v.value.y)/v.value.scaleY;if(t.evt?.shiftKey){const I=$t(be.value.x/l.value,be.value.y/l.value,p/l.value,f/l.value);p=I.endX*l.value,f=I.endY*l.value}const g=rt(p/l.value,f/l.value,z.value);g.snapped&&(p=g.x*l.value,f=g.y*l.value),_e.value={startX:be.value.x,startY:be.value.y,endX:p,endY:f};return}if(at.value&&Qe.value){const x=t.target.getStage().getPointerPosition(),p=(x.x-v.value.x)/v.value.scaleX,f=(x.y-v.value.y)/v.value.scaleY,g=Qe.value.x,I=Qe.value.y,T=Math.min(g,p),K=Math.min(I,f),B=Math.abs(p-g),Se=Math.abs(f-I);Le.value={x:T,y:K,width:B,height:Se};return}if(!me.value)return;const o=t.target.getStage().getPointerPosition(),a=o.x-Ue.value.x,s=o.y-Ue.value.y;v.value.x+=a,v.value.y+=s,Ue.value={x:o.x,y:o.y}},Ll=t=>{if(ke.value&&be.value&&_e.value){const o=be.value.x/l.value,a=be.value.y/l.value;let s=_e.value.endX/l.value,d=_e.value.endY/l.value;if(t?.evt?.shiftKey){const g=$t(o,a,s,d);s=g.endX,d=g.endY}const x=rt(o,a,z.value),p=rt(s,d,z.value);let f=jo(be.value.x,be.value.y,_e.value.endX,_e.value.endY,l.value);if(f){x.snapped&&x.snapType==="segment"&&x.snappedWall&&(f=tl(f,x.snappedWall,"start")),p.snapped&&p.snapType==="segment"&&p.snappedWall&&(f=tl(f,p.snappedWall,"end"));const g=To(f,z.value);N.value&&g.removedWallIds.includes(N.value.id)&&(N.value=null,C.value=!1,ze()),z.value=g.walls,Q()}be.value=null,_e.value=null;return}if(at.value&&Le.value){const o=Le.value;if(o.width<=5&&o.height<=5){at.value=!1,Qe.value=null,Le.value=null;return}if(o.width>5||o.height>5){const a=[];for(const s of Y.value){const d={x:s.x,y:s.y,width:s.width,height:s.height};St(o,d)&&a.push({id:s.id,type:"furniture"})}for(const s of z.value){const d=hl(s);St(o,d)&&a.push({id:s.id,type:"wall"})}for(const s of ie.value){const d={x:s.x,y:s.y,width:s.width,height:s.width};St(o,d)&&a.push({id:s.id,type:"door"})}if(a.length>0){if(t.evt?.shiftKey)for(const s of a)he.value.some(d=>d.id===s.id&&d.type===s.type)||he.value.push(s);else he.value=a;if(he.value.length===1){const s=he.value[0];s.type==="furniture"?E.value=Y.value.find(d=>d.id===s.id)||null:s.type==="wall"?N.value=z.value.find(d=>d.id===s.id)||null:s.type==="door"&&(m.value=ie.value.find(d=>d.id===s.id)||null),he.value=[]}ze()}}at.value=!1,Qe.value=null,Le.value=null;return}me.value=!1},Rl=t=>{t.target===t.target.getStage()&&(E.value=null,m.value=null,N.value=null,ye.value=null,F.value=!1,C.value=!1,W.value=!1,ze())},Pl=()=>{const a={id:`room-${Date.now()}`,x:0,y:0,width:se.value*l.value,height:Xe.value*l.value,opacity:1,zIndex:0};u.value=a;const s=Wo(a,l.value);z.value.push(...s),v.value.x=50,v.value.y=50,v.value.scaleX=1,v.value.scaleY=1,ae.value=!1,Q()},Wl=t=>{t.preventDefault();const o=t.dataTransfer?.getData("application/json");if(!o)return;const a=JSON.parse(o),s=_.value?.getBoundingClientRect();if(!s)return;const d=t.clientX-s.left-v.value.x,x=t.clientY-s.top-v.value.y,p={id:`${a.id}-${Date.now()}`,name:a.name,x:d/v.value.scaleX,y:x/v.value.scaleY,width:a.width,height:a.height,color:a.color,rotation:0,zIndex:Qs(Y.value),shape:a.shape,lShapeDirection:a.lShapeDirection,lShapeRatio:a.lShapeRatio};Y.value.push(p),E.value=p,Q(),ze()},vt=(t,o)=>!(t.right<=o.left||t.left>=o.right||t.bottom<=o.top||t.top>=o.bottom),El=(t,o,a)=>{const s=Ve(o,a,t);if(u.value){const d=u.value;if(s.left<d.x||s.right>d.x+d.width||s.top<d.y||s.bottom>d.y+d.height)return!1}for(const d of Y.value){if(d.id===t.id)continue;const x=Ve(d.x,d.y,d);if(vt(s,x))return!1}for(const d of ie.value){const x=Mt(d);if(vt(s,x))return!1}return!0},Mt=t=>{if(!u.value)return{left:0,top:0,right:0,bottom:0};const o=u.value,a=t.width*l.value;switch(t.wall){case"top":return{left:o.x+t.x*l.value,top:o.y-5,right:o.x+t.x*l.value+a,bottom:o.y+5};case"bottom":return{left:o.x+t.x*l.value,top:o.y+o.height-5,right:o.x+t.x*l.value+a,bottom:o.y+o.height+5};case"left":return{left:o.x-5,top:o.y+t.y*l.value,right:o.x+5,bottom:o.y+t.y*l.value+a};case"right":return{left:o.x+o.width-5,top:o.y+t.y*l.value,right:o.x+o.width+5,bottom:o.y+t.y*l.value+a}}},ft=(t,o,a)=>{if(!u.value)return!1;const s={...t,x:o,y:a},d=Mt(s);for(const x of ie.value){if(x.id===t.id)continue;const p=Mt(x);if(vt(d,p))return!1}for(const x of Y.value){const p=Ve(x.x,x.y,x);if(vt(d,p))return!1}return!0},Ve=(t,o,a)=>{const s=a.width*l.value,d=a.height*l.value,x=a.rotation,p=x===90||x===270,f=p?d:s,g=p?s:d,I=t+s/2,T=o+d/2;return{left:I-f/2,top:T-g/2,right:I+f/2,bottom:T+g/2,width:f,height:g}},Et=(t,o,a)=>{const s=Ve(t,o,a);let d=0,x=0,p=nl,f=nl;if(u.value){const g=u.value,I=Math.abs(s.left-g.x);I<p&&(p=I,d=g.x-s.left);const T=Math.abs(s.right-(g.x+g.width));T<p&&(p=T,d=g.x+g.width-s.right);const K=Math.abs(s.top-g.y);K<f&&(f=K,x=g.y-s.top);const B=Math.abs(s.bottom-(g.y+g.height));B<f&&(f=B,x=g.y+g.height-s.bottom)}for(const g of Y.value){if(g.id===a.id)continue;const I=Ve(g.x,g.y,g),T=Math.abs(s.left-I.right);T<p&&(p=T,d=I.right-s.left);const K=Math.abs(s.right-I.left);K<p&&(p=K,d=I.left-s.right);const B=Math.abs(s.left-I.left);B<p&&(p=B,d=I.left-s.left);const Se=Math.abs(s.right-I.right);Se<p&&(p=Se,d=I.right-s.right);const O=Math.abs(s.top-I.bottom);O<f&&(f=O,x=I.bottom-s.top);const Z=Math.abs(s.bottom-I.top);Z<f&&(f=Z,x=I.top-s.bottom);const ee=Math.abs(s.top-I.top);ee<f&&(f=ee,x=I.top-s.top);const Re=Math.abs(s.bottom-I.bottom);Re<f&&(f=Re,x=I.bottom-s.bottom)}return{x:t+d,y:o+x}},gt=(t,o,a)=>{const s=a.width*l.value,d=a.height*l.value;return{x:t-s/2,y:o-d/2}},Fl=(t,o,a)=>{const s=a.width*l.value,d=a.height*l.value;return{x:t+s/2,y:o+d/2}},zl=(t,o)=>{const a=o.target,d=a.getStage().getPointerPosition(),x=o.evt?.button;if(Fe.value||x===1||x===2){me.value=!0,Ue.value={x:d.x,y:d.y},o.evt?.preventDefault(),a.stopDrag();return}if(he.value.length>0&&Pt(t.id,"furniture")){const p=[];for(const g of he.value)if(g.type==="furniture"){const I=Y.value.find(T=>T.id===g.id);I&&p.push({id:I.id,type:"furniture",originalX:I.x,originalY:I.y})}else if(g.type==="door"){const I=ie.value.find(T=>T.id===g.id);I&&p.push({id:I.id,type:"door",originalX:I.x,originalY:I.y})}else if(g.type==="wall"){const I=z.value.find(T=>T.id===g.id);I&&p.push({id:I.id,type:"wall",originalX:I.startX,originalY:I.startY,originalEndX:I.endX,originalEndY:I.endY})}const f=gt(a.x(),a.y(),t);we.value={startX:f.x,startY:f.y,items:p}}else we.value=null},jl=(t,o)=>{const a=o.target,s=gt(a.x(),a.y(),t),d=Et(s.x,s.y,t),x=Fl(d.x,d.y,t);if(a.x(x.x),a.y(x.y),we.value){const p=(s.x-we.value.startX)/l.value,f=(s.y-we.value.startY)/l.value;for(const g of we.value.items)if(!(g.type==="furniture"&&g.id===t.id)){if(g.type==="furniture"){const I=Y.value.find(T=>T.id===g.id);I&&(I.x=g.originalX+p*l.value,I.y=g.originalY+f*l.value)}else if(g.type==="door"){const I=ie.value.find(T=>T.id===g.id);I&&(I.x=g.originalX+p,I.y=g.originalY+f)}else if(g.type==="wall"){const I=z.value.find(T=>T.id===g.id);I&&g.originalEndX!==void 0&&g.originalEndY!==void 0&&(I.startX=g.originalX+p,I.startY=g.originalY+f,I.endX=g.originalEndX+p,I.endY=g.originalEndY+f)}}}},Tl=(t,o)=>{const a=o.target,s=gt(a.x(),a.y(),t),d=Et(s.x,s.y,t);if(t.x=d.x,t.y=d.y,we.value){const x=(s.x-we.value.startX)/l.value,p=(s.y-we.value.startY)/l.value;for(const f of we.value.items)if(!(f.type==="furniture"&&f.id===t.id)){if(f.type==="furniture"){const g=Y.value.find(I=>I.id===f.id);g&&(g.x=f.originalX+x*l.value,g.y=f.originalY+p*l.value)}else if(f.type==="door"){const g=ie.value.find(I=>I.id===f.id);g&&(g.x=f.originalX+x,g.y=f.originalY+p)}else if(f.type==="wall"){const g=z.value.find(I=>I.id===f.id);g&&f.originalEndX!==void 0&&f.originalEndY!==void 0&&(g.startX=f.originalX+x,g.startY=f.originalY+p,g.endX=f.originalEndX+x,g.endY=f.originalEndY+p)}}we.value=null}Q()},Ul=(t,o)=>{me.value=!1,o?.evt?.ctrlKey||o?.evt?.metaKey?(ct(t.id,"furniture"),E.value||(E.value=t)):(nt(),E.value=t,m.value=null,N.value=null,ye.value=null,F.value=!1,C.value=!1),ze()},Bl=t=>{E.value=t,m.value=null,C.value=!0,ze()},Ft=()=>{C.value=!1},ze=()=>{He(()=>{if(!R.value)return;const t=R.value.getNode();if(!t)return;if(!E.value){t.nodes([]),t.getLayer()?.batchDraw();return}const o=M().get(E.value.id);if(o){const a=o.getNode?o.getNode():o;t.nodes([a]),t.getLayer()?.batchDraw()}})},Al=(t,o)=>{const a=Ti*l.value,s=Ui*l.value;return o.width<a||o.height<a||o.width>s||o.height>s?t:o},Gl=(t,o)=>{const a=o.target,s=a.scaleX(),d=a.scaleY(),x=Math.round(t.width*s),p=Math.round(t.height*d);a.scaleX(1),a.scaleY(1),t.width=Math.max(10,Math.min(500,x)),t.height=Math.max(10,Math.min(500,p));const f=gt(a.x(),a.y(),t);t.x=f.x,t.y=f.y,a.offsetX(t.width*l.value/2),a.offsetY(t.height*l.value/2),ze()};Ne(E,()=>{He(()=>{ze()})},{flush:"post"});const Ol=(t,o,a)=>{if(!u.value)return{wall:"bottom",x:0,y:0};const s=u.value,d=Math.abs(o-s.y),x=Math.abs(o-(s.y+s.height)),p=Math.abs(t-s.x),f=Math.abs(t-(s.x+s.width)),g=Math.min(d,x,p,f);return g===d?{wall:"top",x:Math.max(0,Math.min((s.width-a)/l.value,(t-s.x)/l.value)),y:0}:g===x?{wall:"bottom",x:Math.max(0,Math.min((s.width-a)/l.value,(t-s.x)/l.value)),y:0}:g===p?{wall:"left",x:0,y:Math.max(0,Math.min((s.height-a)/l.value,(o-s.y)/l.value))}:{wall:"right",x:0,y:Math.max(0,Math.min((s.height-a)/l.value,(o-s.y)/l.value))}},Vl=(t,o)=>{const a=o.target,d=a.getStage().getPointerPosition(),x=o.evt?.button;if(Fe.value||x===1||x===2){me.value=!0,Ue.value={x:d.x,y:d.y},o.evt?.preventDefault(),a.stopDrag();return}},Hl=(t,o)=>{if(!u.value)return;const a=o.target,s=t.width*l.value,d=a.x(),x=a.y(),p=Ol(d,x,s);t.wall=p.wall,t.x=p.x,t.y=p.y,Q()},Nl=(t,o)=>{me.value=!1,o?.evt?.ctrlKey||o?.evt?.metaKey?(ct(t.id,"door"),m.value||(m.value=t)):(nt(),m.value=t,E.value=null,N.value=null,ye.value=null,F.value=!1,C.value=!1)},Kl=t=>{m.value=t,E.value=null,C.value=!0},zt=()=>{const t={id:`door-${Date.now()}`,x:V.value==="top"||V.value==="bottom"?G.value:0,y:V.value==="left"||V.value==="right"?G.value:0,width:w.value,wall:V.value,openDirection:"inside",hingeSide:"left"};ie.value.push(t),m.value=t,Ye.value=!1,Q()},Jl=t=>{if(!E.value)return;const o=Y.value.findIndex(s=>s.id===E.value?.id),a=Y.value[o];if(o!==-1&&a){const s=Bs(a,t);Y.value[o]=s,E.value=s,Q()}},jt=()=>{E.value&&(Y.value=Y.value.filter(t=>t.id!==E.value?.id),E.value=null,Q())},Zl=(t,o)=>{const a=Y.value.findIndex(s=>s.id===t);if(a!==-1){const s=Y.value[a];if(s){const d={...s,...o};Y.value[a]=d,E.value?.id===t&&(E.value=d),Q()}}},Be=()=>{He(()=>{const t=$.value?.getNode();if(!t)return;[...Y.value].sort((a,s)=>a.zIndex-s.zIndex).forEach(a=>{const s=M().get(a.id);if(s){const d=s.getNode?s.getNode():s;d&&typeof d.moveToTop=="function"&&d.moveToTop()}}),t.batchDraw()})},Ze=()=>{if(E.value){const t=Y.value.find(o=>o.id===E.value.id);t&&(E.value=t)}},Tt=()=>{E.value&&(Y.value=ea(Y.value,E.value.id),Ze(),Be(),Q())},Ut=()=>{E.value&&(Y.value=ta(Y.value,E.value.id),Ze(),Be(),Q())},Bt=()=>{E.value&&(Y.value=ll(Y.value,E.value.id),Ze(),Be(),Q())},At=()=>{E.value&&(Y.value=ol(Y.value,E.value.id),Ze(),Be(),Q())},ql=t=>{me.value=!1,E.value=t,m.value=null,F.value=!1,ot.value=null,N.value=null,ye.value=null},Ql=t=>{me.value=!1,ot.value=t.id,E.value=null,m.value=null,F.value=!1,N.value=null,ye.value=null},eo=t=>{me.value=!1,F.value=!0,E.value=null,m.value=null,ot.value=null,N.value=null,ye.value=null},to=t=>{me.value=!1,N.value=t,E.value=null,m.value=null,F.value=!1,ot.value=null,ye.value=null},lo=t=>{Y.value=ll(Y.value,t.id),Ze(),Be(),Q()},oo=t=>{Y.value=ol(Y.value,t.id),Ze(),Be(),Q()},no=t=>{Y.value=Y.value.filter(o=>o.id!==t.id),E.value?.id===t.id&&(E.value=null),Be(),Q()},so=t=>{J.value&&J.value.id===t.id&&(J.value={...J.value,locked:!J.value.locked})},ao=(t,o)=>{Y.value=la(Y.value,t,o),Ze(),Be(),Q()},Gt=()=>{L.value=!L.value,L.value||(j.value=null,oe.value=null),L.value&&(E.value=null,m.value=null,C.value=!1,ke.value=!1,be.value=null,_e.value=null)},Ot=()=>{ke.value=!ke.value,ke.value||(be.value=null,_e.value=null),ke.value&&(E.value=null,m.value=null,N.value=null,C.value=!1,L.value=!1,j.value=null,oe.value=null)},Vt=()=>{N.value&&(z.value=z.value.filter(t=>t.id!==N.value?.id),N.value=null,Ee.value=!1,Q())},io=(t,o)=>{me.value=!1,o?.evt?.ctrlKey||o?.evt?.metaKey?(ct(t.id,"wall"),N.value||(N.value=t)):(nt(),E.value=null,m.value=null,ye.value=null,F.value=!1,N.value=t,C.value=!1)},it=P(null),ro=(t,o)=>{const a=t.target,d=a.getStage().getPointerPosition(),x=t.evt?.button;if(Fe.value||x===1||x===2){me.value=!0,Ue.value={x:d.x,y:d.y},t.evt?.preventDefault(),a.stopDrag();return}if(it.value={x:a.x(),y:a.y()},he.value.length>0&&Pt(o.id,"wall")){const p=[];for(const f of he.value)if(f.type==="furniture"){const g=Y.value.find(I=>I.id===f.id);g&&p.push({id:g.id,type:"furniture",originalX:g.x,originalY:g.y})}else if(f.type==="door"){const g=ie.value.find(I=>I.id===f.id);g&&p.push({id:g.id,type:"door",originalX:g.x,originalY:g.y})}else if(f.type==="wall"){const g=z.value.find(I=>I.id===f.id);g&&p.push({id:g.id,type:"wall",originalX:g.startX,originalY:g.startY,originalEndX:g.endX,originalEndY:g.endY})}we.value={startX:a.x(),startY:a.y(),items:p}}else we.value=null},uo=(t,o)=>{if(!it.value)return;const a=t.target,s=a.x(),d=a.y(),x=s-it.value.x,p=d-it.value.y,f=x/l.value,g=p/l.value,I=z.value.findIndex(T=>T.id===o.id);if(I!==-1){const T=z.value[I];if(T){const K={...T,startX:T.startX+f,startY:T.startY+g,endX:T.endX+f,endY:T.endY+g};z.value[I]=K,N.value=K}}if(we.value){for(const T of we.value.items)if(!(T.type==="wall"&&T.id===o.id)){if(T.type==="furniture"){const K=Y.value.find(B=>B.id===T.id);K&&(K.x=T.originalX+f*l.value,K.y=T.originalY+g*l.value)}else if(T.type==="door"){const K=ie.value.find(B=>B.id===T.id);K&&(K.x=T.originalX+f,K.y=T.originalY+g)}else if(T.type==="wall"){const K=z.value.find(B=>B.id===T.id);K&&T.originalEndX!==void 0&&T.originalEndY!==void 0&&(K.startX=T.originalX+f,K.startY=T.originalY+g,K.endX=T.originalEndX+f,K.endY=T.originalEndY+g)}}we.value=null}it.value=null,Q()},co=t=>{N.value=t,Ee.value=!0,C.value=!1},vo=()=>{Ee.value=!1},fo=(t,o,a)=>{const s=t.target,d=s.x()/l.value,x=s.y()/l.value,p=z.value.findIndex(g=>g.id===o.id);if(p===-1)return;const f=z.value[p];f&&(a==="start"?z.value[p]={...f,startX:d,startY:x}:z.value[p]={...f,endX:d,endY:x},N.value?.id===o.id&&(N.value=z.value[p]??null))},go=(t,o,a)=>{const s=t.target;let d=s.x()/l.value,x=s.y()/l.value;if(t.evt?.shiftKey){const T=a==="start"?o.endX:o.startX,K=a==="start"?o.endY:o.startY,B=$t(T,K,d,x);d=B.endX,x=B.endY}const p=z.value.filter(T=>T.id!==o.id),f=rt(d,x,p);d=f.x,x=f.y;const g=z.value.findIndex(T=>T.id===o.id);if(g===-1)return;const I=z.value[g];I&&(a==="start"?z.value[g]={...I,startX:d,startY:x}:z.value[g]={...I,endX:d,endY:x},N.value?.id===o.id&&(N.value=z.value[g]??null),s.x(d*l.value),s.y(x*l.value),Q())},po=t=>{if(!N.value)return;const o=z.value.findIndex(s=>s.id===N.value?.id),a=z.value[o];if(o!==-1&&a){const s={...a,thickness:t.thickness,isExterior:t.isExterior,color:t.color};z.value[o]=s,N.value=s,Q()}},ho=t=>{if(!N.value||t.length===0)return;const o=N.value,a=o.startX,s=o.startY,d=o.endX,x=o.endY;for(const p of t){const f=z.value.findIndex(Z=>Z.id===p);if(f===-1)continue;const g=z.value[f];if(!g)continue;const I=(Z,ee,Re,et)=>Math.sqrt((Z-Re)**2+(ee-et)**2),K=[{currentPoint:"end",wallPoint:"start",dist:I(d,x,g.startX,g.startY)},{currentPoint:"end",wallPoint:"end",dist:I(d,x,g.endX,g.endY)},{currentPoint:"start",wallPoint:"start",dist:I(a,s,g.startX,g.startY)},{currentPoint:"start",wallPoint:"end",dist:I(a,s,g.endX,g.endY)}].reduce((Z,ee)=>ee.dist<Z.dist?ee:Z),B=K.currentPoint==="end"?d:a,Se=K.currentPoint==="end"?x:s,O={...g};K.wallPoint==="start"?(O.startX=B,O.startY=Se):(O.endX=B,O.endY=Se),z.value[f]=O}Ee.value=!1,Q()},mo=t=>{if(!N.value||t.length===0)return;const o=N.value,a=[];for(const x of t){const p=z.value.find(f=>f.id===x);p&&a.push(p)}if(a.length===0)return;const s=Uo(o,a,{checkCollinear:!1});if(!s.joinedWall)return;z.value=z.value.filter(x=>!s.removedWallIds.includes(x.id));const d=z.value.findIndex(x=>x.id===o.id);d!==-1&&(z.value[d]=s.joinedWall,N.value=s.joinedWall),Ee.value=!1,Q()},xo=()=>{de.value=[],j.value=null,oe.value=null},Ht=t=>{if(!L.value)return;const a=t.target.getStage().getPointerPosition(),s=(a.x-v.value.x)/v.value.scaleX,d=(a.y-v.value.y)/v.value.scaleY,x={x:s,y:d};if(!j.value)j.value=x;else{const p=Ws(j.value,x);de.value.push(p),j.value=null,oe.value=null}},yo=t=>{if(!L.value||!j.value)return;const a=t.target.getStage().getPointerPosition(),s=(a.x-v.value.x)/v.value.scaleX,d=(a.y-v.value.y)/v.value.scaleY;oe.value={x:s,y:d}},bo=()=>{_t.value?.click()},wo=async t=>{const o=t.target,a=o.files?.[0];if(a){try{const s=await qs(a);u.value&&(s.x=u.value.x,s.y=u.value.y),J.value=s}catch(s){console.error("í‰ë©´ë„ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:",s),alert(s instanceof Error?s.message:"ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}o.value=""}},ko=()=>{J.value=null},So=()=>{J.value&&(J.value.locked=!J.value.locked)},Do=t=>{if(!J.value||J.value.locked)return;const o=t.target;J.value.x=o.x(),J.value.y=o.y()},Mo=t=>{if(!m.value)return;const o=ie.value.findIndex(s=>s.id===m.value?.id),a=ie.value[o];if(o!==-1&&a){const s=As(a,t);ie.value[o]=s,m.value=s,Q()}},Nt=()=>{m.value&&(ie.value=ie.value.filter(t=>t.id!==m.value?.id),m.value=null,Q())},Co=(t,o)=>{const a=ie.value.findIndex(s=>s.id===t);if(a!==-1){const s=ie.value[a];if(s){const d={...s,...o};ie.value[a]=d,m.value?.id===t&&(m.value=d),Q()}}},Kt=t=>{if(t.code==="Space"&&!Fe.value&&(Fe.value=!0,t.preventDefault()),t.target.tagName==="INPUT"||t.target.tagName==="SELECT")return;if(t.ctrlKey&&t.key==="z"&&!t.shiftKey){t.preventDefault(),wt();return}if(t.ctrlKey&&t.key==="y"||t.ctrlKey&&t.shiftKey&&t.key==="Z"){t.preventDefault(),kt();return}t.key==="Delete"&&E.value&&jt(),t.key==="r"&&E.value&&(E.value.rotation=(E.value.rotation+90)%360,Q()),t.key==="Escape"&&(L.value?(L.value=!1,j.value=null,oe.value=null):ke.value?(ke.value=!1,be.value=null,_e.value=null):C.value?C.value=!1:Ee.value?Ee.value=!1:W.value?Dt():(E.value=null,m.value=null,N.value=null,F.value=!1)),t.key==="m"&&!C.value&&Gt(),t.key==="w"&&!C.value&&Ot(),t.key==="Delete"&&N.value&&Vt(),t.key==="p"&&!C.value&&(Ke.value=!Ke.value),t.key==="Delete"&&m.value&&Nt(),t.key==="d"&&m.value&&(m.value.openDirection=m.value.openDirection==="inside"?"outside":"inside"),t.key==="h"&&m.value&&(m.value.hingeSide=m.value.hingeSide==="left"?"right":"left"),t.key==="Enter"&&(E.value&&!C.value||m.value&&!C.value?C.value=!0:N.value&&!Ee.value?Ee.value=!0:F.value&&!W.value&&Wt()),E.value&&!C.value&&(t.key==="]"&&(t.preventDefault(),t.ctrlKey?Tt():Bt()),t.key==="["&&(t.preventDefault(),t.ctrlKey?Ut():At()));const o=t.shiftKey?10:1;if(F.value&&u.value){const a=u.value,s=a.x,d=a.y;t.key==="ArrowLeft"?(t.preventDefault(),a.x-=o*l.value):t.key==="ArrowRight"?(t.preventDefault(),a.x+=o*l.value):t.key==="ArrowUp"?(t.preventDefault(),a.y-=o*l.value):t.key==="ArrowDown"&&(t.preventDefault(),a.y+=o*l.value),(a.x!==s||a.y!==d)&&Q()}if(E.value){const a=E.value;let s=a.x,d=a.y;t.key==="ArrowLeft"?(t.preventDefault(),s=a.x-o*l.value):t.key==="ArrowRight"?(t.preventDefault(),s=a.x+o*l.value):t.key==="ArrowUp"?(t.preventDefault(),d=a.y-o*l.value):t.key==="ArrowDown"&&(t.preventDefault(),d=a.y+o*l.value),El(a,s,d)&&(a.x!==s||a.y!==d)&&(a.x=s,a.y=d,Q())}if(m.value){const a=m.value,s=a.wall==="top"||a.wall==="bottom",d=a.x,x=a.y;if(s){if(t.key==="ArrowLeft"){t.preventDefault();const p=Math.max(0,a.x-o);ft(a,p,a.y)&&(a.x=p)}else if(t.key==="ArrowRight"&&(t.preventDefault(),u.value)){const p=u.value.width/l.value-a.width,f=Math.min(p,a.x+o);ft(a,f,a.y)&&(a.x=f)}}else if(t.key==="ArrowUp"){t.preventDefault();const p=Math.max(0,a.y-o);ft(a,a.x,p)&&(a.y=p)}else if(t.key==="ArrowDown"&&(t.preventDefault(),u.value)){const p=u.value.height/l.value-a.width,f=Math.min(p,a.y+o);ft(a,a.x,f)&&(a.y=f)}(a.x!==d||a.y!==x)&&Q()}if(N.value){const a=N.value;let s=0,d=0;if(t.key==="ArrowLeft"?(t.preventDefault(),s=-o):t.key==="ArrowRight"?(t.preventDefault(),s=o):t.key==="ArrowUp"?(t.preventDefault(),d=-o):t.key==="ArrowDown"&&(t.preventDefault(),d=o),s!==0||d!==0){const x=z.value.findIndex(p=>p.id===a.id);if(x!==-1){const p=z.value[x];if(p){const f={...p,startX:p.startX+s,startY:p.startY+d,endX:p.endX+s,endY:p.endY+d};z.value[x]=f,N.value=f,Q()}}}}},Ct=()=>{_.value&&(v.value.width=_.value.clientWidth,v.value.height=_.value.clientHeight)},Jt=t=>{t.code==="Space"&&(Fe.value=!1,me.value=!1)};It(()=>{Ct(),window.addEventListener("resize",Ct),window.addEventListener("keydown",Kt),window.addEventListener("keyup",Jt),v.value.x=v.value.width/2,v.value.y=v.value.height/2}),_o(()=>{window.removeEventListener("resize",Ct),window.removeEventListener("keydown",Kt),window.removeEventListener("keyup",Jt)});const $o=()=>{Eo({room:u.value,furnitureList:Y.value,doorList:ie.value,wallList:z.value,floorPlanImage:J.value})},Zt=()=>{if(!u.value)return;const t=50;v.value.x=t-u.value.x+t,v.value.y=t-u.value.y+t,v.value.scaleX=1,v.value.scaleY=1};return i({room:u,furnitureList:Y,doorList:ie,wallList:z,floorPlanImage:J,groups:qe,scale:l,selectedFurniture:E,selectedDoor:m,selectedWall:N,selectedFloorPlanImageId:ot,isRoomSelected:F,selectedGroup:ye,multiSelectedItems:he,toggleMultiSelect:ct,clearMultiSelect:nt,updateFurniture:Zl,updateDoor:Co,updateRoom:Il,updateWall:Xl,updateRoomWallThickness:Yl,showDoorModal:Ye,doorWall:V,doorPosition:G,doorWidth:w,createDoor:zt,saveToLocalStorage:$o,loadFromLocalStorage:()=>{const t=Fo();return t?(t.room?u.value={...t.room,id:t.room.id||`room-${Date.now()}`,zIndex:t.room.zIndex??0}:u.value=null,Y.value=t.furnitureList||[],ie.value=t.doorList||[],z.value=t.wallList||[],J.value=t.floorPlanImage||null,E.value=null,m.value=null,N.value=null,He(()=>{Zt(),Be()}),!0):!1},exportJson:()=>{zo({room:u.value,furnitureList:Y.value,doorList:ie.value,wallList:z.value,floorPlanImage:J.value})},exportImage:(t="png")=>{if(!b.value||!u.value)return;const o=b.value.getNode(),a={x:o.x(),y:o.y()},s={x:o.scaleX(),y:o.scaleY()},d=50,x=u.value;o.position({x:d-x.x,y:d-x.y}),o.scale({x:1,y:1});const p=o.toDataURL({x:0,y:0,width:x.width+d*2,height:x.height+d*2,pixelRatio:2,mimeType:t==="jpeg"?"image/jpeg":"image/png",quality:.95});o.position(a),o.scale(s);const f=document.createElement("a");f.href=p,f.download=`floor-plan-${new Date().toISOString().slice(0,10)}.${t}`,f.click()},resetViewToRoom:Zt,undo:wt,redo:kt,canUndo:Je.canUndo,canRedo:Je.canRedo,onLayerSelect:ql,onLayerSelectImage:Ql,onLayerSelectRoom:eo,onLayerSelectWall:to,onLayerSelectGroup:il,onLayerReorder:ao,onLayerMoveForward:lo,onLayerMoveBackward:oo,onLayerDelete:no,onToggleImageLock:so,onCreateGroup:rl,onUngroup:ul}),(t,o)=>{const a=re("v-image"),s=re("v-layer"),d=ks,x=Ms,p=re("v-transformer"),f=$s,g=Xs,I=re("v-rect"),T=_s,K=Rs,B=zs,Se=re("v-stage");return y(),S("div",{ref_key:"containerRef",ref:_,class:xe(["flex-1 bg-gray-200 overflow-hidden relative",{"cursor-grab":Fe.value,"cursor-grabbing":me.value}]),onDrop:Wl,onDragover:o[17]||(o[17]=We(()=>{},["prevent"])),onDragenter:o[18]||(o[18]=We(()=>{},["prevent"])),onContextmenu:o[19]||(o[19]=We(()=>{},["prevent"]))},[A(Se,{ref_key:"stageRef",ref:b,config:v.value,onWheel:wl,onMousedown:kl,onMousemove:_l,onMouseup:Ll,onClick:Rl,onContextmenu:o[2]||(o[2]=O=>O.evt?.preventDefault())},{default:fe(()=>[A(s,{config:{listening:!0}},{default:fe(()=>[J.value&&dt.value?(y(),ve(a,{key:0,config:{x:J.value.x,y:J.value.y,image:dt.value,width:J.value.width*J.value.scale,height:J.value.height*J.value.scale,opacity:J.value.opacity,draggable:!J.value.locked},onDragend:Do},null,8,["config"])):H("",!0)]),_:1}),A(s,{ref_key:"objectLayerRef",ref:$},{default:fe(()=>[A(d,{ref_key:"roomLayerRef",ref:D,room:u.value,scale:l.value,"is-selected":F.value,onMousedown:Sl,onClick:Dl,onDblclick:Wt,onTransformend:Cl},null,8,["room","scale","is-selected"]),A(x,{doors:ie.value,room:u.value,scale:l.value,"selected-door-id":m.value?.id||null,"multi-selected-ids":gl.value,onSelect:Nl,onDblclick:Kl,onDragstart:Vl,onDragend:Hl},null,8,["doors","room","scale","selected-door-id","multi-selected-ids"]),F.value&&u.value?(y(),ve(p,{key:0,ref_key:"roomTransformerRef",ref:ue,config:{rotateEnabled:!1,keepRatio:!1,enabledAnchors:["top-left","top-right","bottom-left","bottom-right","top-center","bottom-center","middle-left","middle-right"],anchorSize:12,anchorCornerRadius:2,borderStroke:"#3b82f6",anchorStroke:"#3b82f6",anchorFill:"#ffffff",boundBoxFunc:Ml}},null,8,["config"])):H("",!0),A(f,{walls:z.value,scale:l.value,"selected-wall-id":N.value?.id||null,"multi-selected-ids":pl.value,"is-wall-draw-mode":ke.value,"show-polygon-view":Ke.value,"wall-draw-preview":_e.value,onClick:io,onDblclick:co,onDragstart:ro,onDragend:uo,onEndpointDrag:fo,onEndpointDragEnd:go},null,8,["walls","scale","selected-wall-id","multi-selected-ids","is-wall-draw-mode","show-polygon-view","wall-draw-preview"]),A(g,{ref_key:"furnitureLayerRef",ref:X,"furniture-list":Y.value,scale:l.value,"multi-selected-ids":fl.value,onDragstart:zl,onDragmove:jl,onDragend:Tl,onSelect:Ul,onDblclick:Bl,onTransformend:Gl},null,8,["furniture-list","scale","multi-selected-ids"]),A(p,{ref_key:"transformerRef",ref:R,config:{rotateEnabled:!1,keepRatio:!1,enabledAnchors:["top-left","top-right","bottom-left","bottom-right","top-center","bottom-center","middle-left","middle-right"],boundBoxFunc:Al,anchorSize:10,anchorCornerRadius:2,borderStroke:"#3b82f6",anchorStroke:"#3b82f6",anchorFill:"#ffffff"}},null,8,["config"]),te(A(I,{config:E.value?.shape==="l-shape"?c(E.value):{visible:!1},onDragmove:o[0]||(o[0]=O=>h(E.value,O))},null,8,["config"]),[[Qt,E.value?.shape==="l-shape"]]),te(A(I,{config:E.value?.shape==="l-shape"?r(E.value):{visible:!1},onDragmove:o[1]||(o[1]=O=>k(E.value,O))},null,8,["config"]),[[Qt,E.value?.shape==="l-shape"]]),A(T,{groups:qe.value,"selected-group-id":ye.value?.id||null,onClick:dl,onDragstart:cl,onDragend:vl},null,8,["groups","selected-group-id"])]),_:1},512),A(s,null,{default:fe(()=>[A(K,{"distance-lines":xl.value},null,8,["distance-lines"]),A(B,{measurements:de.value,"start-point":j.value,"current-point":oe.value,scale:l.value},null,8,["measurements","start-point","current-point","scale"]),Le.value?(y(),ve(I,{key:0,config:{x:Le.value.x,y:Le.value.y,width:Le.value.width,height:Le.value.height,fill:"rgba(59, 130, 246, 0.1)",stroke:"#3b82f6",strokeWidth:1,dash:[5,5],listening:!1}},null,8,["config"])):H("",!0)]),_:1})]),_:1},8,["config"]),L.value?(y(),S("div",ti,[o[20]||(o[20]=e("span",null,"ì¸¡ì • ëª¨ë“œ",-1)),j.value?(y(),S("span",li,"í´ë¦­í•˜ì—¬ ëì  ì„¤ì •")):(y(),S("span",oi,"í´ë¦­í•˜ì—¬ ì‹œì‘ì  ì„¤ì •"))])):H("",!0),ke.value?(y(),S("div",ni,[o[21]||(o[21]=e("span",null,"ë²½ì²´ ê·¸ë¦¬ê¸° ëª¨ë“œ",-1)),be.value?(y(),S("span",si,"ë“œë˜ê·¸í•˜ì—¬ ë²½ì²´ ìƒì„±")):(y(),S("span",ai,"í´ë¦­í•˜ì—¬ ì‹œì‘ì  ì„¤ì • (Shift: ê°ë„ ìŠ¤ëƒ…)"))])):H("",!0),e("div",ii,[e("button",{class:xe(["w-10 h-10 rounded-lg shadow flex items-center justify-center",ke.value?"bg-green-600 text-white":"bg-white hover:bg-gray-50"]),title:"ë²½ì²´ ê·¸ë¦¬ê¸° (W)",onClick:Ot},[...o[22]||(o[22]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])],2),e("button",{class:xe(["w-10 h-10 rounded-lg shadow flex items-center justify-center",Ke.value?"bg-purple-600 text-white":"bg-white hover:bg-gray-50"]),title:"í´ë¦¬ê³¤ ë·° (P)",onClick:o[3]||(o[3]=O=>Ke.value=!Ke.value)},[...o[23]||(o[23]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM14 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zM4 15a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4zM14 15a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"})],-1)])],2),e("button",{class:xe(["w-10 h-10 rounded-lg shadow flex items-center justify-center",L.value?"bg-red-500 text-white":"bg-white hover:bg-gray-50"]),title:"ì¸¡ì • ë„êµ¬ (M)",onClick:Gt},[...o[24]||(o[24]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2v16z"})],-1)])],2),de.value.length>0?(y(),S("button",{key:0,class:"w-10 h-10 bg-white rounded-lg shadow flex items-center justify-center hover:bg-gray-50",title:"ì¸¡ì • ì´ˆê¸°í™”",onClick:xo},[...o[25]||(o[25]=[e("svg",{class:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])):H("",!0),e("button",{class:"w-10 h-10 bg-white rounded-lg shadow flex items-center justify-center hover:bg-gray-50",onClick:yl}," + "),e("button",{class:"w-10 h-10 bg-white rounded-lg shadow flex items-center justify-center hover:bg-gray-50",onClick:bl}," - "),e("button",{class:"w-10 h-10 bg-white rounded-lg shadow flex items-center justify-center hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed",disabled:!le(Je).canUndo.value,title:"ì‹¤í–‰ ì·¨ì†Œ (Ctrl+Z)",onClick:wt},[...o[26]||(o[26]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})],-1)])],8,ri),e("button",{class:"w-10 h-10 bg-white rounded-lg shadow flex items-center justify-center hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed",disabled:!le(Je).canRedo.value,title:"ë‹¤ì‹œ ì‹¤í–‰ (Ctrl+Y)",onClick:kt},[...o[27]||(o[27]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})],-1)])],8,ui),e("button",{class:"w-10 h-10 bg-white rounded-lg shadow flex items-center justify-center hover:bg-gray-50",title:"í‰ë©´ë„ ì´ë¯¸ì§€ ì—…ë¡œë“œ",onClick:bo},[...o[28]||(o[28]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])])]),e("input",{ref_key:"floorPlanImageRef",ref:_t,type:"file",accept:"image/*",class:"hidden",onChange:wo},null,544),J.value?(y(),S("div",di,[e("div",ci,[o[30]||(o[30]=e("span",{class:"text-sm font-medium text-gray-700"},"í‰ë©´ë„ ì´ë¯¸ì§€",-1)),e("div",vi,[e("button",{class:xe(["p-1.5 rounded hover:bg-gray-100",J.value.locked?"text-blue-500":"text-gray-400"]),title:"ì ê¸ˆ",onClick:So},[(y(),S("svg",fi,[J.value.locked?(y(),S("path",gi)):(y(),S("path",pi))]))],2),e("button",{class:"p-1.5 rounded hover:bg-gray-100 text-red-500",title:"ì‚­ì œ",onClick:ko},[...o[29]||(o[29]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])]),e("div",hi,[e("div",null,[e("label",mi,"íˆ¬ëª…ë„ ("+U(Math.round(J.value.opacity*100))+"%)",1),te(e("input",{"onUpdate:modelValue":o[4]||(o[4]=O=>J.value.opacity=O),type:"range",min:"0.1",max:"1",step:"0.1",class:"w-full"},null,512),[[ce,J.value.opacity,void 0,{number:!0}]])]),e("div",null,[e("label",xi,"í¬ê¸° ("+U(Math.round(J.value.scale*100))+"%)",1),te(e("input",{"onUpdate:modelValue":o[5]||(o[5]=O=>J.value.scale=O),type:"range",min:"0.1",max:"3",step:"0.1",class:"w-full"},null,512),[[ce,J.value.scale,void 0,{number:!0}]])])])])):H("",!0),u.value?H("",!0):(y(),S("div",yi,[e("button",{class:"px-4 py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600",onClick:o[6]||(o[6]=O=>ae.value=!0)}," + ë°© ë§Œë“¤ê¸° ")])),m.value&&C.value?(y(),S("div",bi,[A(Pa,{door:m.value,onUpdate:Mo,onDelete:Nt,onClose:Ft},null,8,["door"])])):H("",!0),E.value&&C.value?(y(),S("div",wi,[A(wa,{furniture:E.value,onUpdate:Jl,onDelete:jt,onClose:Ft},null,8,["furniture"])])):H("",!0),N.value&&Ee.value?(y(),S("div",ki,[A(ei,{wall:N.value,"all-walls":z.value,onUpdate:po,onDelete:Vt,onMerge:ho,onJoin:mo,onClose:vo},null,8,["wall","all-walls"])])):H("",!0),E.value&&!C.value?(y(),S("div",Si,[e("div",{class:"bg-white rounded-lg shadow-lg p-2 flex items-center gap-1"},[o[35]||(o[35]=e("span",{class:"text-xs text-gray-500 px-2"},"ë ˆì´ì–´:",-1)),e("button",{class:"p-1.5 hover:bg-gray-100 rounded text-gray-600",title:"ë§¨ ë’¤ë¡œ (Ctrl+[)",onClick:Ut},[...o[31]||(o[31]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)])]),e("button",{class:"p-1.5 hover:bg-gray-100 rounded text-gray-600",title:"í•œ ë‹¨ê³„ ë’¤ë¡œ ([)",onClick:At},[...o[32]||(o[32]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])]),e("button",{class:"p-1.5 hover:bg-gray-100 rounded text-gray-600",title:"í•œ ë‹¨ê³„ ì•ìœ¼ë¡œ (])",onClick:Bt},[...o[33]||(o[33]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"})],-1)])]),e("button",{class:"p-1.5 hover:bg-gray-100 rounded text-gray-600",title:"ë§¨ ì•ìœ¼ë¡œ (Ctrl+])",onClick:Tt},[...o[34]||(o[34]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 10l7-7m0 0l7 7m-7-7v18"})],-1)])])])])):H("",!0),F.value&&W.value?(y(),S("div",Di,[e("div",Mi,[e("div",{class:"flex items-center justify-between mb-3"},[o[37]||(o[37]=e("h3",{class:"font-semibold text-gray-800"},"ë°© í¬ê¸° ìˆ˜ì •",-1)),e("button",{class:"text-gray-400 hover:text-gray-600",onClick:Dt},[...o[36]||(o[36]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Ci,[e("div",null,[o[38]||(o[38]=e("label",{class:"block text-sm text-gray-600 mb-1"},"ê°€ë¡œ (cm)",-1)),te(e("input",{"onUpdate:modelValue":o[7]||(o[7]=O=>De.value=O),type:"number",min:"1",class:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"},null,512),[[ce,De.value,void 0,{number:!0}]])]),e("div",null,[o[39]||(o[39]=e("label",{class:"block text-sm text-gray-600 mb-1"},"ì„¸ë¡œ (cm)",-1)),te(e("input",{"onUpdate:modelValue":o[8]||(o[8]=O=>Me.value=O),type:"number",min:"1",class:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"},null,512),[[ce,Me.value,void 0,{number:!0}]])]),e("div",null,[e("label",$i," íˆ¬ëª…ë„: "+U(Math.round(Ce.value*100))+"% ",1),te(e("input",{"onUpdate:modelValue":o[9]||(o[9]=O=>Ce.value=O),type:"range",min:"0",max:"1",step:"0.1",class:"w-full"},null,512),[[ce,Ce.value,void 0,{number:!0}]])]),Ie.value?(y(),S("div",Ii,U(Ie.value),1)):H("",!0),e("div",{class:"flex gap-2 pt-2"},[e("button",{class:"flex-1 px-3 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 text-sm",onClick:Dt}," ì·¨ì†Œ "),e("button",{class:"flex-1 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 text-sm",onClick:$l}," ì ìš© ")])])])])):H("",!0),ae.value?(y(),S("div",Xi,[e("div",Yi,[o[42]||(o[42]=e("h3",{class:"text-lg font-semibold mb-4"},"ë°© í¬ê¸° ì…ë ¥",-1)),e("div",_i,[e("div",null,[o[40]||(o[40]=e("label",{class:"block text-sm text-gray-600 mb-1"},"ê°€ë¡œ (cm)",-1)),te(e("input",{"onUpdate:modelValue":o[10]||(o[10]=O=>se.value=O),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"ì˜ˆ: 400"},null,512),[[ce,se.value,void 0,{number:!0}]])]),e("div",null,[o[41]||(o[41]=e("label",{class:"block text-sm text-gray-600 mb-1"},"ì„¸ë¡œ (cm)",-1)),te(e("input",{"onUpdate:modelValue":o[11]||(o[11]=O=>Xe.value=O),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"ì˜ˆ: 300"},null,512),[[ce,Xe.value,void 0,{number:!0}]])]),e("div",Li,[e("button",{class:"flex-1 px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",onClick:o[12]||(o[12]=O=>ae.value=!1)}," ì·¨ì†Œ "),e("button",{class:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",onClick:Pl}," ìƒì„± ")])])])])):H("",!0),Ye.value?(y(),S("div",Ri,[e("div",Pi,[o[46]||(o[46]=e("h3",{class:"text-lg font-semibold mb-4"},"ë¬¸ ì¶”ê°€",-1)),e("div",Wi,[e("div",null,[o[44]||(o[44]=e("label",{class:"block text-sm text-gray-600 mb-1"},"ë²½ ì„ íƒ",-1)),te(e("select",{"onUpdate:modelValue":o[13]||(o[13]=O=>V.value=O),class:"w-full px-3 py-2 border border-gray-300 rounded-lg"},[...o[43]||(o[43]=[e("option",{value:"top"},"ìœ„ìª½ ë²½",-1),e("option",{value:"bottom"},"ì•„ë˜ìª½ ë²½",-1),e("option",{value:"left"},"ì™¼ìª½ ë²½",-1),e("option",{value:"right"},"ì˜¤ë¥¸ìª½ ë²½",-1)])],512),[[yt,V.value]])]),e("div",null,[e("label",Ei," ìœ„ì¹˜ ("+U(V.value==="top"||V.value==="bottom"?"ì™¼ìª½ì—ì„œ":"ìœ„ì—ì„œ")+" cm) ",1),te(e("input",{"onUpdate:modelValue":o[14]||(o[14]=O=>G.value=O),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"ì˜ˆ: 100"},null,512),[[ce,G.value,void 0,{number:!0}]])]),e("div",null,[o[45]||(o[45]=e("label",{class:"block text-sm text-gray-600 mb-1"},"ë¬¸ ë„ˆë¹„ (cm)",-1)),te(e("input",{"onUpdate:modelValue":o[15]||(o[15]=O=>w.value=O),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"ì˜ˆ: 90"},null,512),[[ce,w.value,void 0,{number:!0}]])]),e("div",Fi,[e("button",{class:"flex-1 px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",onClick:o[16]||(o[16]=O=>Ye.value=!1)}," ì·¨ì†Œ "),e("button",{class:"flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",onClick:zt}," ì¶”ê°€ ")])])])])):H("",!0)],34)}}}),Ai=Object.assign(Bi,{__name:"EditorFloorPlanCanvas"});function Te(n,i){const l=n/i;return Math.round(l*100)/100}function tt(n,i){return n*i}function Gi(n,i,l){if(i){const c=n.x-i.x,r=n.y-i.y;return{x:Te(c,l),y:Te(r,l)}}return{x:Te(n.x,l),y:Te(n.y,l)}}function Oi(n,i){return{width:Te(n.width,i),height:Te(n.height,i)}}function Vi(n,i,l){const c=l*Math.PI/180,r=Math.abs(Math.cos(c)),h=Math.abs(Math.sin(c));return l===90||l===270?{width:i,height:n}:{width:n*r+i*h,height:n*h+i*r}}function Hi(n,i,l){if(!i)return null;const c=Vi(n.width,n.height,n.rotation),r=n.x-i.x,h=n.y-i.y,k=h,_=i.height-(h+c.height),b=r,$=i.width-(r+c.width);return{top:Te(k,l),bottom:Te(_,l),left:Te(b,l),right:Te($,l)}}const Ni=["data-testid"],Ki={class:"text-xs font-medium text-gray-300"},Ji={key:0,"data-testid":"section-content",class:"px-3 pb-3"},Zi=pe({__name:"AttributeSection",props:{title:{},sectionId:{},defaultOpen:{type:Boolean}},setup(n){const l=P(n.defaultOpen??!0);return(c,r)=>(y(),S("div",{"data-testid":`section-${n.sectionId}`,class:"border-b border-gray-700"},[e("button",{"data-testid":"section-header",class:"w-full flex items-center justify-between px-3 py-2 hover:bg-gray-800 transition-colors",onClick:r[0]||(r[0]=h=>l.value=!l.value)},[e("span",Ki,U(n.title),1),(y(),S("svg",{class:xe(["w-3 h-3 text-gray-500 transition-transform",{"rotate-180":!l.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[1]||(r[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),l.value?(y(),S("div",Ji,[Lo(c.$slots,"default")])):H("",!0)],8,Ni))}}),$e=Object.assign(Zi,{__name:"PanelAttributeSection"}),qi={class:"h-full bg-gray-900 text-white flex flex-col"},Qi={class:"flex items-center justify-between px-3 py-2 border-b border-gray-700"},er={class:"flex items-center gap-2"},tr={class:"text-sm font-medium"},lr={key:0,class:"flex-1 overflow-y-auto"},or={key:0,class:"p-4 text-center text-gray-400"},nr={class:"space-y-2"},sr={class:"flex items-center justify-between"},ar={class:"text-xs text-gray-500"},ir={class:"space-y-2"},rr={class:"flex items-center justify-between"},ur={class:"flex items-center gap-1"},dr=["value"],cr={class:"flex items-center justify-between"},vr={class:"flex items-center gap-1"},fr=["value"],gr={class:"space-y-2"},pr={class:"flex items-center justify-between"},hr={class:"flex items-center gap-1"},mr=["value"],xr={class:"space-y-2"},yr={class:"flex items-center justify-between"},br={class:"text-xs text-gray-500 truncate max-w-24"},wr={class:"flex items-center justify-between"},kr={class:"text-xs"},Sr={class:"space-y-2"},Dr={class:"flex items-center justify-between"},Mr={class:"text-xs"},Cr={class:"flex items-center justify-between"},$r={class:"flex items-center gap-1"},Ir=["value"],Xr={class:"space-y-2"},Yr={class:"flex items-center justify-between"},_r={class:"text-xs"},Lr={class:"flex items-center justify-between"},Rr={class:"text-xs"},Pr={class:"space-y-2"},Wr={class:"flex items-center justify-between"},Er=["checked"],Fr={class:"space-y-2"},zr={class:"flex items-center justify-between"},jr=["value"],Tr={class:"flex items-center justify-between"},Ur={class:"text-xs text-gray-500"},Br={class:"space-y-2"},Ar={class:"flex items-center justify-between"},Gr={class:"flex items-center gap-1"},Or={"data-testid":"size-width",class:"text-xs"},Vr=["value"],Hr={class:"flex items-center justify-between"},Nr={class:"flex items-center gap-1"},Kr={"data-testid":"size-height",class:"text-xs"},Jr=["value"],Zr={class:"space-y-2"},qr={class:"flex items-center justify-between"},Qr={class:"flex items-center gap-1"},eu={"data-testid":"position-x",class:"text-xs"},tu=["value"],lu={class:"flex items-center justify-between"},ou={class:"flex items-center gap-1"},nu={"data-testid":"position-y",class:"text-xs"},su=["value"],au={key:0,class:"space-y-2"},iu={class:"flex items-center justify-between"},ru={"data-testid":"distance-top",class:"text-xs"},uu={class:"flex items-center justify-between"},du={"data-testid":"distance-bottom",class:"text-xs"},cu={class:"flex items-center justify-between"},vu={"data-testid":"distance-left",class:"text-xs"},fu={class:"flex items-center justify-between"},gu={"data-testid":"distance-right",class:"text-xs"},pu={key:1,class:"text-xs text-gray-500"},hu={class:"space-y-2"},mu={class:"flex items-center justify-between"},xu={class:"flex items-center gap-1"},yu={"data-testid":"rotation",class:"text-xs"},bu=["value"],wu={class:"space-y-2"},ku={class:"flex items-center justify-between"},Su={class:"text-xs"},Du={class:"flex items-center justify-between"},Mu={class:"text-xs"},Cu={class:"flex items-center justify-between"},$u={class:"text-xs"},Iu={class:"flex items-center justify-between"},Xu={class:"text-xs"},Yu=pe({__name:"AttributePanel",props:{selectedFurniture:{},selectedDoor:{},selectedWall:{},room:{},isRoomSelected:{type:Boolean},scale:{},wallList:{}},emits:["update:furniture","update:door","update:room","update:wall","update:room-wall-thickness"],setup(n,{emit:i}){const l=n,c=i,r=P(!1),h=ne(()=>l.selectedFurniture?l.selectedFurniture.name:l.selectedDoor?"ë¬¸":l.selectedWall?"ë²½ì²´":l.isRoomSelected&&l.room?"ë°©":"ì†ì„±"),k=ne(()=>l.selectedFurniture||l.selectedDoor||l.selectedWall||l.isRoomSelected&&l.room),_=ne(()=>l.selectedFurniture?Oi(l.selectedFurniture,l.scale):{width:0,height:0}),b=ne(()=>l.selectedFurniture?Gi(l.selectedFurniture,l.room,l.scale):{x:0,y:0}),$=ne(()=>l.selectedFurniture?Hi(l.selectedFurniture,l.room,l.scale):null),R=ne(()=>l.room?l.wallList.find(w=>w.roomId===l.room?.id)?.thickness??15:15),D=ne(()=>({top:"ìƒë‹¨",bottom:"í•˜ë‹¨",left:"ì¢Œì¸¡",right:"ìš°ì¸¡"})[l.selectedDoor?.wall||""]||""),X=ne(()=>l.selectedDoor?.openDirection==="inside"?"ì•ˆìª½":"ë°”ê¹¥ìª½"),M=ne(()=>l.selectedDoor?.hingeSide==="left"?"ì™¼ìª½":"ì˜¤ë¥¸ìª½"),v=ne(()=>l.selectedDoor?Math.round(l.selectedDoor.width/l.scale):0),u=ne(()=>l.room?{width:l.room.widthCm||Math.round(l.room.width/l.scale),height:l.room.heightCm||Math.round(l.room.height/l.scale)}:{width:0,height:0}),F=ne(()=>{if(!l.selectedWall)return null;const G=l.selectedWall;return{length:Math.round(Oe(G)),thickness:G.thickness,isExterior:G.isExterior,startX:Math.round(G.startX),startY:Math.round(G.startY),endX:Math.round(G.endX),endY:Math.round(G.endY)}});function ue(G){const w=G.target;c("update:furniture",{name:w.value})}function ae(G){const w=G.target,Y=parseFloat(w.value);c("update:furniture",{width:tt(Y,l.scale)})}function W(G){const w=G.target,Y=parseFloat(w.value);c("update:furniture",{height:tt(Y,l.scale)})}function se(G){const w=G.target,Y=parseFloat(w.value),E=tt(Y,l.scale)+(l.room?.x||0);c("update:furniture",{x:E})}function Xe(G){const w=G.target,Y=parseFloat(w.value),E=tt(Y,l.scale)+(l.room?.y||0);c("update:furniture",{y:E})}function De(G){const w=G.target;c("update:furniture",{rotation:parseFloat(w.value)})}function Me(G){const w=G.target,Y=parseFloat(w.value);c("update:room",{widthCm:Y,width:tt(Y,l.scale)})}function Ce(G){const w=G.target,Y=parseFloat(w.value);c("update:room",{heightCm:Y,height:tt(Y,l.scale)})}function Ie(G){const w=G.target,Y=parseFloat(w.value);Y>=5&&Y<=50&&c("update:room-wall-thickness",Y)}function Ye(G){const w=G.target;c("update:wall",{thickness:parseFloat(w.value)})}function V(G){const w=G.target;c("update:wall",{isExterior:w.checked})}return(G,w)=>(y(),S("div",qi,[e("div",Qi,[e("div",er,[e("span",tr,U(h.value),1)]),e("button",{"data-testid":"toggle-panel",class:"p-1 hover:bg-gray-700 rounded",onClick:w[0]||(w[0]=Y=>r.value=!r.value)},[(y(),S("svg",{class:xe(["w-4 h-4 transition-transform",{"rotate-180":r.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...w[12]||(w[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])]),r.value?H("",!0):(y(),S("div",lr,[k.value?n.isRoomSelected&&n.room?(y(),S(q,{key:1},[A($e,{title:"ê¸°ë³¸ ì •ë³´","section-id":"room-info","default-open":!0},{default:fe(()=>[e("div",nr,[e("div",sr,[w[14]||(w[14]=e("label",{class:"text-xs text-gray-400"},"ID",-1)),e("span",ar,U(n.room.id),1)])])]),_:1}),A($e,{title:"í¬ê¸°","section-id":"room-size","default-open":!0},{default:fe(()=>[e("div",ir,[e("div",rr,[w[16]||(w[16]=e("label",{class:"text-xs text-gray-400"},"ê°€ë¡œ",-1)),e("div",ur,[e("input",{"data-testid":"input-room-width",type:"number",value:u.value.width,class:"w-20 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[1]||(w[1]=Y=>Me(Y))},null,40,dr),w[15]||(w[15]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])]),e("div",cr,[w[18]||(w[18]=e("label",{class:"text-xs text-gray-400"},"ì„¸ë¡œ",-1)),e("div",vr,[e("input",{"data-testid":"input-room-height",type:"number",value:u.value.height,class:"w-20 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[2]||(w[2]=Y=>Ce(Y))},null,40,fr),w[17]||(w[17]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])])])]),_:1}),A($e,{title:"ì™¸ë²½","section-id":"room-wall","default-open":!0},{default:fe(()=>[e("div",gr,[e("div",pr,[w[20]||(w[20]=e("label",{class:"text-xs text-gray-400"},"ë‘ê»˜",-1)),e("div",hr,[e("input",{"data-testid":"input-room-wall-thickness",type:"number",value:R.value,min:"5",max:"50",class:"w-16 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[3]||(w[3]=Y=>Ie(Y))},null,40,mr),w[19]||(w[19]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])])])]),_:1})],64)):n.selectedWall&&F.value?(y(),S(q,{key:2},[A($e,{title:"ê¸°ë³¸ ì •ë³´","section-id":"wall-info","default-open":!0},{default:fe(()=>[e("div",xr,[e("div",yr,[w[21]||(w[21]=e("label",{class:"text-xs text-gray-400"},"ID",-1)),e("span",br,U(n.selectedWall.id),1)]),e("div",wr,[w[22]||(w[22]=e("label",{class:"text-xs text-gray-400"},"ìœ í˜•",-1)),e("span",kr,U(F.value.isExterior?"ì™¸ë²½":"ë‚´ë²½"),1)])])]),_:1}),A($e,{title:"í¬ê¸°","section-id":"wall-size","default-open":!0},{default:fe(()=>[e("div",Sr,[e("div",Dr,[w[23]||(w[23]=e("label",{class:"text-xs text-gray-400"},"ê¸¸ì´",-1)),e("span",Mr,U(F.value.length)+" cm",1)]),e("div",Cr,[w[25]||(w[25]=e("label",{class:"text-xs text-gray-400"},"ë‘ê»˜",-1)),e("div",$r,[e("input",{"data-testid":"input-wall-thickness",type:"number",value:F.value.thickness,min:"5",max:"50",class:"w-16 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[4]||(w[4]=Y=>Ye(Y))},null,40,Ir),w[24]||(w[24]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])])])]),_:1}),A($e,{title:"ìœ„ì¹˜","section-id":"wall-position","default-open":!0},{default:fe(()=>[e("div",Xr,[e("div",Yr,[w[26]||(w[26]=e("label",{class:"text-xs text-gray-400"},"ì‹œì‘ì ",-1)),e("span",_r,"("+U(F.value.startX)+", "+U(F.value.startY)+")",1)]),e("div",Lr,[w[27]||(w[27]=e("label",{class:"text-xs text-gray-400"},"ëì ",-1)),e("span",Rr,"("+U(F.value.endX)+", "+U(F.value.endY)+")",1)])])]),_:1}),A($e,{title:"ì†ì„±","section-id":"wall-props","default-open":!0},{default:fe(()=>[e("div",Pr,[e("div",Wr,[w[28]||(w[28]=e("label",{class:"text-xs text-gray-400"},"ì™¸ë²½ ì—¬ë¶€",-1)),e("input",{"data-testid":"input-wall-exterior",type:"checkbox",checked:F.value.isExterior,class:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-blue-500 focus:ring-blue-500",onChange:w[5]||(w[5]=Y=>V(Y))},null,40,Er)])])]),_:1})],64)):n.selectedFurniture?(y(),S(q,{key:3},[A($e,{title:"ê¸°ë³¸ ì •ë³´","section-id":"info","default-open":!0},{default:fe(()=>[e("div",Fr,[e("div",zr,[w[29]||(w[29]=e("label",{class:"text-xs text-gray-400"},"ì´ë¦„",-1)),e("input",{"data-testid":"input-name",type:"text",value:n.selectedFurniture.name,class:"w-32 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[6]||(w[6]=Y=>ue(Y))},null,40,jr)]),e("div",Tr,[w[30]||(w[30]=e("label",{class:"text-xs text-gray-400"},"ID",-1)),e("span",Ur,U(n.selectedFurniture.id),1)])])]),_:1}),A($e,{title:"í¬ê¸°","section-id":"size","default-open":!0},{default:fe(()=>[e("div",Br,[e("div",Ar,[w[32]||(w[32]=e("label",{class:"text-xs text-gray-400"},"ê°€ë¡œ",-1)),e("div",Gr,[e("span",Or,U(_.value.width),1),e("input",{"data-testid":"input-width",type:"number",value:_.value.width,class:"w-16 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[7]||(w[7]=Y=>ae(Y))},null,40,Vr),w[31]||(w[31]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])]),e("div",Hr,[w[34]||(w[34]=e("label",{class:"text-xs text-gray-400"},"ì„¸ë¡œ",-1)),e("div",Nr,[e("span",Kr,U(_.value.height),1),e("input",{"data-testid":"input-height",type:"number",value:_.value.height,class:"w-16 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[8]||(w[8]=Y=>W(Y))},null,40,Jr),w[33]||(w[33]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])])])]),_:1}),A($e,{title:"ìœ„ì¹˜","section-id":"position","default-open":!0},{default:fe(()=>[e("div",Zr,[e("div",qr,[w[36]||(w[36]=e("label",{class:"text-xs text-gray-400"},"X",-1)),e("div",Qr,[e("span",eu,U(b.value.x),1),e("input",{"data-testid":"input-x",type:"number",value:b.value.x,class:"w-16 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[9]||(w[9]=Y=>se(Y))},null,40,tu),w[35]||(w[35]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])]),e("div",lu,[w[38]||(w[38]=e("label",{class:"text-xs text-gray-400"},"Y",-1)),e("div",ou,[e("span",nu,U(b.value.y),1),e("input",{"data-testid":"input-y",type:"number",value:b.value.y,class:"w-16 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[10]||(w[10]=Y=>Xe(Y))},null,40,su),w[37]||(w[37]=e("span",{class:"text-xs text-gray-500"},"cm",-1))])])])]),_:1}),A($e,{title:"ë²½ê³¼ì˜ ê±°ë¦¬","section-id":"distance","default-open":!0},{default:fe(()=>[$.value?(y(),S("div",au,[e("div",iu,[w[39]||(w[39]=e("label",{class:"text-xs text-gray-400"},"ìƒë‹¨",-1)),e("span",ru,U($.value.top)+" cm",1)]),e("div",uu,[w[40]||(w[40]=e("label",{class:"text-xs text-gray-400"},"í•˜ë‹¨",-1)),e("span",du,U($.value.bottom)+" cm",1)]),e("div",cu,[w[41]||(w[41]=e("label",{class:"text-xs text-gray-400"},"ì¢Œì¸¡",-1)),e("span",vu,U($.value.left)+" cm",1)]),e("div",fu,[w[42]||(w[42]=e("label",{class:"text-xs text-gray-400"},"ìš°ì¸¡",-1)),e("span",gu,U($.value.right)+" cm",1)])])):(y(),S("div",pu," ë°©ì„ ìƒì„±í•˜ë©´ ê±°ë¦¬ê°€ í‘œì‹œë©ë‹ˆë‹¤ "))]),_:1}),A($e,{title:"íšŒì „","section-id":"rotation","default-open":!0},{default:fe(()=>[e("div",hu,[e("div",mu,[w[44]||(w[44]=e("label",{class:"text-xs text-gray-400"},"ê°ë„",-1)),e("div",xu,[e("span",yu,U(n.selectedFurniture.rotation),1),e("input",{"data-testid":"input-rotation",type:"number",value:n.selectedFurniture.rotation,step:"15",class:"w-16 px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded focus:border-blue-500 focus:outline-none",onChange:w[11]||(w[11]=Y=>De(Y))},null,40,bu),w[43]||(w[43]=e("span",{class:"text-xs text-gray-500"},"Â°",-1))])])])]),_:1})],64)):n.selectedDoor?(y(),ve($e,{key:4,title:"ë¬¸ ì •ë³´","section-id":"door-info","default-open":!0},{default:fe(()=>[e("div",wu,[e("div",ku,[w[45]||(w[45]=e("label",{class:"text-xs text-gray-400"},"ìœ„ì¹˜",-1)),e("span",Su,U(D.value),1)]),e("div",Du,[w[46]||(w[46]=e("label",{class:"text-xs text-gray-400"},"ë„ˆë¹„",-1)),e("span",Mu,U(v.value)+" cm",1)]),e("div",Cu,[w[47]||(w[47]=e("label",{class:"text-xs text-gray-400"},"ì—´ë¦¼ ë°©í–¥",-1)),e("span",$u,U(X.value),1)]),e("div",Iu,[w[48]||(w[48]=e("label",{class:"text-xs text-gray-400"},"ê²½ì²© ìœ„ì¹˜",-1)),e("span",Xu,U(M.value),1)])])]),_:1})):H("",!0):(y(),S("div",or,[...w[13]||(w[13]=[e("p",null,"ì„ íƒëœ ì˜¤ë¸Œì íŠ¸ ì—†ìŒ",-1),e("p",{class:"text-xs mt-1"},"ì˜¤ë¸Œì íŠ¸ë¥¼ ì„ íƒí•˜ë©´ ì†ì„±ì´ í‘œì‹œë©ë‹ˆë‹¤",-1)])]))]))]))}}),_u=Object.assign(Yu,{__name:"PanelAttributePanel"}),Lu={class:"flex flex-1 overflow-hidden"},Ru={class:"w-64 bg-white border-r border-gray-200 flex flex-col shrink-0 overflow-hidden"},Pu={class:"w-64 bg-gray-900 border-l border-gray-700 shrink-0 overflow-hidden"},Uu=pe({__name:"index",setup(n){const i=P(null),l=P("furniture"),c=P(!0),r=P(!0),h=P(20),k=Bo("canvasRef",()=>null);Ne(i,V=>{k.value=V},{immediate:!0});const _=()=>{i.value?.room&&(i.value.showDoorModal=!0)},b=V=>{i.value?.onLayerSelect&&i.value.onLayerSelect(V)},$=V=>{i.value?.onLayerSelectImage&&i.value.onLayerSelectImage(V)},R=V=>{i.value?.onLayerSelectRoom&&i.value.onLayerSelectRoom(V)},D=V=>{i.value?.onLayerSelectWall&&i.value.onLayerSelectWall(V)},X=V=>{i.value?.onLayerSelectGroup&&i.value.onLayerSelectGroup(V)},M=(V,G)=>{i.value?.onLayerReorder&&i.value.onLayerReorder(V,G)},v=V=>{i.value?.onLayerMoveForward&&i.value.onLayerMoveForward(V)},u=V=>{i.value?.onLayerMoveBackward&&i.value.onLayerMoveBackward(V)},F=V=>{i.value?.onLayerDelete&&i.value.onLayerDelete(V)},ue=V=>{i.value?.onToggleImageLock&&i.value.onToggleImageLock(V)},ae=V=>{i.value?.onCreateGroup&&i.value.onCreateGroup(V)},W=V=>{i.value?.onUngroup&&i.value.onUngroup(V)},se=(V,G)=>{i.value?.toggleMultiSelect&&i.value.toggleMultiSelect(V,G)},Xe=()=>{i.value?.clearMultiSelect&&i.value.clearMultiSelect()},De=V=>{i.value?.selectedFurniture&&i.value?.updateFurniture&&i.value.updateFurniture(i.value.selectedFurniture.id,V)},Me=V=>{i.value?.selectedDoor&&i.value?.updateDoor&&i.value.updateDoor(i.value.selectedDoor.id,V)},Ce=V=>{i.value?.room&&i.value?.updateRoom&&i.value.updateRoom(V)},Ie=V=>{i.value?.selectedWall&&i.value?.updateWall&&i.value.updateWall(i.value.selectedWall.id,V)},Ye=V=>{i.value?.updateRoomWallThickness&&i.value.updateRoomWallThickness(V)};return It(()=>{He(()=>{i.value?.loadFromLocalStorage&&i.value.loadFromLocalStorage()})}),Ao({title:"ì—ë””í„° - ì´ì‚¬í•  ë•Œ"}),(V,G)=>{const w=qo,Y=Cn,E=os,ie=ds,m=bs,C=Ai,L=_u;return y(),S("div",Lu,[A(w,{activePanel:le(l),"onUpdate:activePanel":G[0]||(G[0]=j=>Ro(l)?l.value=j:null)},null,8,["activePanel"]),e("aside",Ru,[le(l)==="furniture"?(y(),ve(Y,{key:0,onAddDoor:_})):le(l)==="layers"?(y(),ve(E,{key:1,embedded:"",items:le(i)?.furnitureList||[],selectedId:le(i)?.selectedFurniture?.id||null,image:le(i)?.floorPlanImage||null,selectedImageId:le(i)?.selectedFloorPlanImageId||null,room:le(i)?.room||null,isRoomSelected:le(i)?.isRoomSelected||!1,walls:le(i)?.wallList||[],selectedWallId:le(i)?.selectedWall?.id||null,groups:le(i)?.groups||[],selectedGroupId:le(i)?.selectedGroup?.id||null,multiSelectedItems:le(i)?.multiSelectedItems||[],onSelect:b,onSelectImage:$,onSelectRoom:R,onSelectWall:D,onSelectGroup:X,onReorder:M,onMoveForward:v,onMoveBackward:u,onDelete:F,onToggleLock:ue,onCreateGroup:ae,onUngroup:W,onToggleMultiSelect:se,onClearSelection:Xe},null,8,["items","selectedId","image","selectedImageId","room","isRoomSelected","walls","selectedWallId","groups","selectedGroupId","multiSelectedItems"])):le(l)==="history"?(y(),ve(ie,{key:2,"can-undo":le(i)?.history?.canUndo?.value||!1,"can-redo":le(i)?.history?.canRedo?.value||!1,onUndo:G[1]||(G[1]=j=>le(i)?.undo?.()),onRedo:G[2]||(G[2]=j=>le(i)?.redo?.())},null,8,["can-undo","can-redo"])):le(l)==="settings"?(y(),ve(m,{key:3,"show-grid":le(c),"snap-to-grid":le(r),"grid-size":le(h),"onUpdate:showGrid":G[3]||(G[3]=j=>c.value=j),"onUpdate:snapToGrid":G[4]||(G[4]=j=>r.value=j),"onUpdate:gridSize":G[5]||(G[5]=j=>h.value=j)},null,8,["show-grid","snap-to-grid","grid-size"])):H("",!0)]),A(C,{ref_key:"canvasRef",ref:i},null,512),e("aside",Pu,[A(L,{"selected-furniture":le(i)?.selectedFurniture||null,"selected-door":le(i)?.selectedDoor||null,"selected-wall":le(i)?.selectedWall||null,room:le(i)?.room||null,"is-room-selected":le(i)?.isRoomSelected||!1,scale:le(i)?.scale||2,"wall-list":le(i)?.wallList||[],"onUpdate:furniture":De,"onUpdate:door":Me,"onUpdate:room":Ce,"onUpdate:wall":Ie,"onUpdate:roomWallThickness":Ye},null,8,["selected-furniture","selected-door","selected-wall","room","is-room-selected","scale","wall-list"])])])}}});export{Uu as default};
