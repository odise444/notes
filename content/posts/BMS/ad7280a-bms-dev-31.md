---
title: "AD7280A BMS 개발기 #31 - 부품 선정, 아무거나 쓰면 안 되더라"
date: 2024-12-14
draft: false
tags: ["AD7280A", "BMS", "STM32", "부품선정", "BOM"]
categories: ["BMS 개발"]
series: ["AD7280A BMS 개발"]
summary: "저항은 그냥 1kΩ 아무거나, 커패시터도 100nF 아무거나. 그게 문제였다."
---

회로도 완성하고 BOM 작성했다. 저항 1kΩ 50개, 커패시터 100nF 30개, 이런 식으로.

"저항은 그냥 1kΩ 아무거나" 했던 게 문제였다.

---

## 저항 정밀도

AD7280A 셀 입력에 1kΩ 저항을 달았다. 부품함에서 대충 집었다.

셀 전압 측정해보니까 어떤 건 정확하고 어떤 건 10mV 넘게 틀렸다. 패턴도 없었다.

저항을 멀티미터로 측정해봤다.

```
R1: 1023Ω (+2.3%)
R2: 987Ω  (-1.3%)
R3: 1048Ω (+4.8%)
R4: 962Ω  (-3.8%)
```

5% 오차 저항이라 그런 거였다. 입력 저항이 다르면 AD7280A 내부 샘플링 커패시터 충전 시간이 달라져서 오차가 생긴다고 한다.

1% 정밀 저항으로 바꾸니까 측정 오차가 ±3mV로 줄었다.

---

## 온도 계수

1% 저항으로 바꿨더니 상온에서는 좋았다. 근데 겨울 되니까 오차가 다시 커졌다.

0도에서 8mV 드리프트, -10도에서 15mV.

저항 온도 계수(TCR)를 확인 안 했다. 일반 후막 저항이 TCR ±200ppm/°C인데, 50도 변화하면 1% 변동이다.

TCR 25ppm 저항으로 바꾸니까 -20도~60도에서 오차 ±5mV 이내로 안정됐다.

정밀 측정용 저항은 정밀도랑 TCR 둘 다 봐야 한다.

---

## 커패시터 종류

디커플링 캡으로 100nF를 달았는데, Y5V 유전체였다.

여름엔 괜찮았는데 겨울에 BMS가 이상 동작했다. 확인해보니까 용량이 반토막 나 있었다.

```
25°C: 100nF
 0°C: 72nF  (-28%)
-20°C: 55nF (-45%)
```

Y5V는 온도 특성이 -30% ~ +22%다. 저온에서 용량이 확 줄어든다.

X7R로 바꿨다. 온도 특성 ±15%로 안정적.

디커플링은 X7R, 타이밍 회로는 C0G. 이거 지금은 기본으로 아는데 그때는 몰랐다.

---

## MOSFET 정격

밸런싱 회로에 2N7002 달았다. 흔한 거라서.

```
2N7002:
- Vds(max): 60V
```

72V 시스템에 60V 소자를 달았다. Cell 24 밸런싱 회로의 MOSFET이 터졌다. 팩 전압이 드레인에 걸릴 수 있다는 걸 생각 못 했다.

200V 정격으로 바꿨다.

---

## 릴레이 접점 용량

프리차지랑 메인 릴레이. 처음엔 저가형으로 샀다.

```
접점 정격: 10A @ 30VDC
```

72V 50A 시스템에 저걸 달았다. 몇 번 개폐하더니 릴레이가 녹았다.

DC는 AC보다 아크 소호가 어렵다. 72V DC에서 아크가 안 꺼지고 접점이 녹아붙었다.

자동차용 고전압 릴레이로 바꿨다. 100A @ 450VDC. 가격이 50배 뛰었는데, 싼 거 3개 태워먹은 비용보다 쌌다.

---

## NTC B값

온도 센싱용 NTC. "10kΩ NTC면 다 똑같지" 했다.

```
10kΩ NTC (B=3380):
50°C: 4.16kΩ

10kΩ NTC (B=3950):
50°C: 3.60kΩ
```

B값이 다르면 저항-온도 커브가 다르다.

룩업 테이블을 B=3950 기준으로 만들어놓고, B=3380 NTC를 달았다.

```
실제 온도: 50°C
표시 온도: 56°C
```

6도 오차. 과열 보호가 엉뚱한 온도에서 동작했다.

B값 맞는 NTC 사서 테이블 다시 만들었다.

---

## 단종 위기

이건 부품 선정이라기보단 수급 문제인데.

양산 준비하다가 부품팀에서 연락 왔다. "AD7280A가 NRND래요."

NRND. Not Recommended for New Design. 단종 예정.

국내 재고 0. 해외 긁어모아서 간신히 1년 치 확보했다.

핵심 부품은 Lifecycle 먼저 확인해야 한다. Active 상태인지, NRND인지, EOL인지.

---

## 정리

부품 선정에서 배운 것들:

- 저항: 정밀도(1%)랑 TCR(50ppm 이하) 둘 다
- 커패시터: 디커플링은 X7R, 타이밍은 C0G
- 반도체: 전압 정격은 시스템 전압의 1.5~2배
- 릴레이: DC 정격 따로 확인, 아크 소호 능력
- 센서: 스펙 일치 확인 (B값 등)
- 공통: Lifecycle 확인

"아무거나"는 없다.

---

다음은 납땜 얘기. 플럭스가 뭔지 몰랐던 시절.

[#32 - 제작 및 조립](/posts/bms/ad7280a-bms-dev-32/)
