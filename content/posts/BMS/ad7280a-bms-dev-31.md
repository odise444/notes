---
title: "AD7280A BMS 개발 삽질기 #31 - 부품 선정, 싼 게 비지떡"
date: 2024-12-14
draft: false
tags: ["AD7280A", "BMS", "STM32", "부품선정", "BOM", "하드웨어"]
categories: ["BMS 개발"]
series: ["AD7280A BMS 개발"]
summary: "'아무 저항이나 1kΩ 달면 되지.' 그 안일함이 3주를 날렸다."
---

## 부품? 그냥 사면 되는 거 아냐?

회로도 완성. BOM(Bill of Materials) 작성.

```
BOM 초안:
- 저항 1kΩ: 50개
- 커패시터 100nF: 30개
- AD7280A: 4개
- STM32F103: 1개
...
```

"저항은 그냥 1kΩ 아무거나, 커패시터도 100nF 아무거나."

**그 '아무거나'가 문제였다.**

---

## 첫 번째 삽질: 저항 정밀도

AD7280A 셀 입력에 1kΩ 저항을 달았다. 부품함에서 집었다.

```
측정 결과:
Cell 0: 3201mV (실제 3200mV) → 오차 1mV ✓
Cell 1: 3215mV (실제 3200mV) → 오차 15mV ✗
Cell 2: 3189mV (실제 3200mV) → 오차 11mV ✗
...
```

어떤 셀은 정확하고, 어떤 셀은 10mV 이상 틀렸다. 패턴이 없었다.

**저항을 멀티미터로 측정해봤다.**

```
1kΩ 저항(5% 오차):
R1: 1023Ω (+2.3%)
R2: 987Ω  (-1.3%)
R3: 1048Ω (+4.8%)
R4: 962Ω  (-3.8%)
...
```

입력 저항이 다르면 AD7280A 내부 샘플링 커패시터 충전 시간이 달라진다. 그래서 오차가 생겼다.

**1% 정밀 저항으로 교체:**

```
1kΩ 저항(1% 오차):
R1: 1002Ω (+0.2%)
R2: 998Ω  (-0.2%)
R3: 1004Ω (+0.4%)
R4: 997Ω  (-0.3%)
...
```

측정 오차가 ±3mV로 줄었다.

**교훈**: 아날로그 신호 경로의 저항은 1% 이상 정밀도 필수.

---

## 두 번째 삽질: 저항 온도 계수

1% 저항으로 바꿨더니 상온에서는 좋았다. **그런데 겨울이 왔다.**

```
25°C: Cell 0 = 3200mV ✓
 0°C: Cell 0 = 3208mV (8mV 드리프트)
-10°C: Cell 0 = 3215mV (15mV 드리프트)
```

온도가 내려가니 오차가 커졌다.

**저항 온도 계수(TCR)를 확인 안 했다.**

```
일반 후막 저항: TCR = ±200ppm/°C
정밀 박막 저항: TCR = ±25ppm/°C
```

200ppm이면 50°C 변화에 1% 변동. 1kΩ이 1010Ω이 된다.

**TCR 25ppm 저항으로 교체.** -20°C ~ 60°C 범위에서 오차 ±5mV 이내로 안정화.

```
저항 선정 기준:
┌────────────────────────────────────────┐
│  정밀도: 1% 이상                        │
│  TCR: 50ppm/°C 이하 (정밀 측정용)       │
│  크기: 0603 또는 0805 (작업성)          │
│  전력: 실사용의 2배 이상               │
└────────────────────────────────────────┘
```

---

## 세 번째 삽질: 커패시터 종류

디커플링 캐패시터. "100nF면 다 똑같은 거 아냐?"

**Y5V vs X7R vs C0G.**

```
Y5V (싼 것):
- 온도 특성: -30% ~ +22% (-30°C ~ 85°C)
- DC 바이어스: 50% 이상 감소 가능
- 가격: 저렴

X7R (일반적):
- 온도 특성: ±15% (-55°C ~ 125°C)
- DC 바이어스: 20~30% 감소
- 가격: 중간

C0G/NP0 (정밀):
- 온도 특성: ±30ppm/°C
- DC 바이어스: 거의 없음
- 가격: 비쌈
```

처음에 Y5V 100nF를 달았다. 겨울에 BMS가 이상 동작했다.

**확인해보니 용량이 반토막 나 있었다.**

```
25°C: 100nF → 100nF (정상)
 0°C: 100nF → 72nF  (28% 감소)
-20°C: 100nF → 55nF (45% 감소!)
```

AD7280A 전원 디커플링이 부실해지면서 노이즈 내성이 떨어졌다.

**X7R로 교체.** 온도 안정성 확보.

```
커패시터 선정 기준:
┌────────────────────────────────────────┐
│  디커플링: X7R 또는 X5R               │
│  타이밍 회로: C0G/NP0                  │
│  벌크 캡: 전해 (ESR 고려)              │
│  정격 전압: 실사용의 2배               │
│  DC 바이어스: 데이터시트 확인!         │
└────────────────────────────────────────┘
```

---

## 네 번째 삽질: MOSFET 선정

밸런싱 회로에 MOSFET을 썼다. 2N7002, 흔한 거.

**스펙:**
```
2N7002:
- Vds(max): 60V
- Id(max): 200mA
- Rds(on): 2Ω @ Vgs=4.5V
```

72V 시스템에 Vds 60V 소자를 달았다. 완전히 생각이 없었다.

Cell 24 밸런싱 회로의 MOSFET이 터졌다. 팩 전압이 MOSFET 드레인에 걸릴 수 있다는 걸 몰랐다.

**100V 정격 MOSFET으로 교체:**

```
BSS138:
- Vds(max): 50V → ✗

Si2302:
- Vds(max): 20V → ✗

AO3400:
- Vds(max): 30V → ✗

IRLML6344:
- Vds(max): 30V → ✗

BSS127:
- Vds(max): 200V → ✓
- Id(max): 500mA
- Rds(on): 0.6Ω
```

**교훈**: 최대 전압 = 시스템 전압 × 1.5 이상.

---

## 다섯 번째 삽질: 릴레이 접점 용량

프리차지 릴레이와 메인 릴레이.

**처음 선정한 릴레이:**
```
저가형 릴레이:
- 접점 정격: 10A @ 30VDC
- 가격: 1,000원
```

72V 50A 시스템에 10A 30V 릴레이를 달았다. "돌아가면 되는 거 아냐?"

몇 번 개폐하더니 릴레이가 녹았다.

```
문제:
- 72V에서 아크 소호 능력 부족
- 50A 돌입 전류에 접점 용착
- 열화 → 접촉 저항 증가 → 과열 → 녹음
```

**자동차용 고전압 릴레이로 교체:**

```
EV용 릴레이:
- 접점 정격: 100A @ 450VDC
- 아크 소호: 자석 방식
- 가격: 50,000원

수명: 10만 회 → 안정적
```

가격이 50배 뛰었지만, 싼 거 3개 태워먹은 비용보다 쌌다.

```
릴레이 선정 기준:
┌────────────────────────────────────────┐
│  전압 정격: 시스템 전압 × 2            │
│  전류 정격: 최대 전류 × 1.5            │
│  DC 정격 확인! (AC 정격과 다름)        │
│  고전압 DC는 아크 소호 능력 중요       │
│  돌입 전류 고려                        │
└────────────────────────────────────────┘
```

---

## 여섯 번째 삽질: NTC 서미스터 B값

온도 센싱용 NTC. "10kΩ NTC면 다 똑같지."

```
10kΩ NTC (B=3380):
 0°C: 27.3kΩ
25°C: 10.0kΩ
50°C: 4.16kΩ

10kΩ NTC (B=3950):
 0°C: 32.7kΩ
25°C: 10.0kΩ
50°C: 3.60kΩ
```

**B값이 다르면 저항-온도 커브가 다르다!**

룩업 테이블을 B=3950 기준으로 만들어놓고, B=3380 NTC를 달았다.

```
결과:
실제 온도: 50°C
표시 온도: 56°C (+6°C 오차)
```

과열 보호가 엉뚱한 온도에서 동작했다.

**B값 맞는 NTC 구매 후 룩업 테이블 재생성.**

```
NTC 선정 기준:
┌────────────────────────────────────────┐
│  저항값: 25°C 기준 (보통 10kΩ)         │
│  B값: 데이터시트 확인 (3380? 3950?)    │
│  오차: ±1% 정밀형 권장                 │
│  온도 범위: 사용 환경 커버 확인         │
│  형태: 표면 실장 / 리드 타입 / 프로브   │
└────────────────────────────────────────┘
```

---

## 일곱 번째 삽질: 재고 부족

양산 준비. BOM 확정하고 구매팀에 넘겼다.

**"AD7280A가 단종 예정이래요."**

심장이 멎는 줄 알았다.

```
상황:
- AD7280A: NRND (Not Recommended for New Design)
- 재고: 국내 0, 해외 소량
- 리드타임: 52주 (1년!)
- 대체품: 없음 (ADBMS 시리즈는 핀 호환 안 됨)
```

급하게 해외 재고 긁어모았다. 100개 확보하는 데 한 달 걸렸다.

**교훈**: 핵심 부품은 수명 주기(Lifecycle) 먼저 확인.

```
부품 Lifecycle 체크:
┌────────────────────────────────────────┐
│  Active: 양산 중 (안전)                │
│  NRND: 신규 설계 비권장 (위험!)        │
│  Last Buy: 마지막 구매 기회            │
│  EOL: 단종 (끝)                        │
│                                        │
│  → 핵심 부품은 Active 상태 확인        │
│  → 대체품 미리 조사                    │
│  → 안전 재고 확보                      │
└────────────────────────────────────────┘
```

---

## 최종 BOM 작성 원칙

수많은 삽질 끝에 정립한 부품 선정 기준:

```
┌─────────────────────────────────────────────┐
│              BOM 작성 체크리스트            │
├─────────────────────────────────────────────┤
│                                             │
│  [저항]                                     │
│  □ 정밀도: 신호 경로 1%, 일반 5%           │
│  □ TCR: 정밀 측정용 50ppm 이하             │
│  □ 전력: 실사용 × 2                        │
│                                             │
│  [커패시터]                                 │
│  □ 유전체: 디커플링 X7R, 타이밍 C0G        │
│  □ 전압: 실사용 × 2                        │
│  □ DC 바이어스 특성 확인                   │
│  □ 온도 범위 확인                          │
│                                             │
│  [반도체]                                   │
│  □ 전압 정격: 시스템 전압 × 1.5            │
│  □ 전류 정격: 최대 전류 × 1.5              │
│  □ 열 특성: Rth, Tj(max)                   │
│  □ Lifecycle: Active 상태 확인             │
│                                             │
│  [릴레이/스위치]                            │
│  □ DC 정격 별도 확인                       │
│  □ 아크 소호 능력 (고전압 DC)              │
│  □ 돌입 전류 내성                          │
│                                             │
│  [센서]                                     │
│  □ 스펙 일치 (B값, 감도 등)                │
│  □ 캘리브레이션 데이터 확보                │
│                                             │
│  [공통]                                     │
│  □ 동작 온도 범위                          │
│  □ 납땜 호환성 (RoHS, Reflow)              │
│  □ 재고/리드타임                           │
│  □ 2nd 소스 확보                           │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 정리: 부품 선정에서 배운 것들

| 삽질 | 부품 | 문제 | 해결 |
|------|------|------|------|
| 측정 오차 | 저항 5% | 불일치 | 1% 정밀 저항 |
| 온도 드리프트 | 저항 200ppm | 저온 오차 | 25ppm 저항 |
| 겨울 오동작 | Y5V 커패시터 | 용량 감소 | X7R 커패시터 |
| MOSFET 파손 | 60V FET | 과전압 | 200V FET |
| 릴레이 녹음 | 10A/30V | 용량 부족 | 100A/450V |
| 온도 오측정 | B값 불일치 | 6°C 오차 | B값 확인 |
| 양산 위기 | AD7280A NRND | 단종 예정 | 재고 선확보 |

**가장 큰 교훈**: 부품은 '아무거나'가 없다. 스펙을 읽어라.

**다음 글에서**: 제작과 조립. 납땜 하나가 3일을 날리는 이야기.

---

## 시리즈 네비게이션

**Part 9: 하드웨어 설계편**
- [#29 - 회로도 설계](/posts/bms/ad7280a-bms-dev-29/)
- [#30 - PCB 레이아웃](/posts/bms/ad7280a-bms-dev-30/)
- **#31 - 부품 선정** ← 현재 글
- #32 - 제작 및 조립

---

## 참고 자료

- [Resistor Selection Guide](https://www.vishay.com/docs/31148/d16.pdf)
- [MLCC Temperature Characteristics](https://www.murata.com/en-global/products/capacitor/mlcc/basic/characteristics)
- [AD7280A Product Lifecycle](https://www.analog.com/en/products/ad7280a.html)
