---
title: "AD7280A BMS 개발기 #30 - PCB 레이아웃"
date: 2024-12-14
draft: false
tags: ["AD7280A", "BMS", "STM32", "PCB", "레이아웃"]
categories: ["BMS 개발"]
series: ["AD7280A BMS 개발"]
summary: "회로도는 맞는데 왜 안 되지? PCB에서 생긴 문제들."
---

회로도 다 됐다고 끝이 아니었다. PCB 레이아웃에서 또 삽질했다.

---

**고전압 이격거리**

72V 패턴이랑 저전압 패턴 사이를 1mm로 했는데, 내압 테스트에서 아크가 튀었다.

솔더마스크에 핀홀이 있었다. 제조 불량. 거기서 방전됐다.

1.5mm 이상으로 넓히고 재발주했다.

---

**Kelvin 연결**

션트 저항으로 전류 측정하는데 30% 오차가 났다.

센스 라인을 전류 경로에서 분기하면 배선 저항까지 같이 측정된다. 션트 저항 **패드에서 직접** 센스 라인을 빼야 한다. 이걸 Kelvin 연결이라고 한다.

수정 후 오차 3% 이내.

---

**발열 분산**

밸런싱 저항을 다닥다닥 붙여놨더니 PCB가 85°C까지 올라갔다.

체커보드로 분산 배치하고, 저항 아래 써멀 비아 추가했다. 65°C로 떨어졌다.

---

**GND 비아**

IC 밑에 GND 비아가 너무 적어서 노이즈가 심했다. K선배가 "비아 더 박아"라고 해서 빽빽하게 추가했더니 노이즈가 확 줄었다.

---

**테스트 포인트**

처음엔 테스트 포인트를 안 넣었다. "공간 낭비잖아."

문제 생기면 0.5mm 핀에 프로브 대야 했다. 손 떨려서 옆 핀 쇼트시켜서 IC 하나 날렸다.

그 뒤로 중요 신호에는 다 테스트 포인트 넣었다.

---

다음 글에서 부품 선정 삽질을 다룬다.

[#31 - 부품 선정](/posts/bms/ad7280a-bms-dev-31/)
